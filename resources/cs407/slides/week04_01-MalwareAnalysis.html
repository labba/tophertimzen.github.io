<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Malware Analysis</title>
    <!-- Styles -->
    
    <link rel="stylesheet" media="print" href="..\slideResources\theme\css\print.css">
    <link rel="stylesheet" media="screen, projection" href="..\slideResources\theme\css\screen.css">
    
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script type="text/javascript" src="..\slideResources\theme\js\slides.js"></script>
    
    
    
    <!-- /Javascripts -->
</head>
<body>
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-1">
          <div class="inner">
            
            <header><h1>Malware Analysis</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              1/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-2">
          <div class="inner">
            
            <header><h1>Resources</h1></header>
            
            
            <section><p>The IDA Pro Book 2nd Edition – Chris Eagle</p>
<p>Practical Malware Analysis – Michael Sikorski and Andrew Honig</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              2/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-3">
          <div class="inner">
            
            <header><h1>Recall. . .</h1></header>
            
            
            <section><p>We can extract binaries and DLLs. </p>
<p>Import Address Table is destroyed when extracting using Volatility.</p>
<ul>
<li>We can recover and use with IDA with Impscan</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              3/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-4">
          <div class="inner">
            
            <header><h1>Reverse Engineering</h1></header>
            
            
            <section><p>Understanding the <Malware, Program, Exploit></p>
<p>Algorithm Discovery </p>
<ul>
<li>Zeus encryption keys
Protocol Discovery</li>
</ul>
<p>Understanding Purpose</p>
<ul>
<li>What did binary do? How? Why? Exfiltration?</li>
<li>Damage caused? </li>
<li>Attribution?</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              4/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-5">
          <div class="inner">
            
            <header><h1>Compilation</h1></header>
            
            
            <section><p>Source → Compiler → Assembler → Linker → Binary on Disk</p>
<p>Because we went through compilation process</p>
<ul>
<li>We lost program design</li>
<li>Source code</li>
<li>Developer comments</li>
<li>Function / variable names</li>
<li>Etc...</li>
</ul>
<p>We are left with machine code!</p>
<pre><code>   01111111 01000101 01001100 01000110
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              5/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-6">
          <div class="inner">
            
            <header><h1>Disassembly</h1></header>
            
            
            <section><p>Generate assembly from machine language</p>
<div class="highlight"><pre><span class="n">Assembly</span> <span class="n">Disasm</span><span class="p">(</span><span class="n">machine</span><span class="p">[])</span>
</pre></div>

<p>Objdump, Dumpbin, IDA, Ollydbg...</p>
<p>Any non-IDE debugger performs disassembly</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              6/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-7">
          <div class="inner">
            
            <header><h1>Disassembly</h1></header>
            
            
            <section><p>Each architecture has different assembly/machine code mapping</p>
<p>Commonly malware is Intel Arch, some in ARM.</p>
<p>Algorithm needs to know how to read the file format to discover what is executable code / what is data. </p>
<p>PE has a lot of data as well as executable sections</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              7/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-8">
          <div class="inner">
            
            <header><h1>Example</h1></header>
            
            
            <section><p>The IA32 Instruction 'ret'</p>
<p>Returns from a function and returns to current stack pointer (Should be old EIP).</p>
<p>Machine Instruction is 0xc3. </p>
<p>Dissassembler sees 0xc3</p>
<ul>
<li>Input: 0xC3</li>
<li>IF Code → ret</li>
<li>ELSE data → 0xc3</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              8/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-9">
          <div class="inner">
            
            <header><h1>Disassembly Algorithms</h1></header>
            
            
            <section><p>**
Linear Sweep</p>
<p>Recursive Descent**</p>
<p>Both take in machine code and output assembly code</p>
<p>Both fail on obfuscated code</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              9/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-10">
          <div class="inner">
            
            <header><h1>Linear Sweep</h1></header>
            
            
            <section><p>Parse down the .text segment linearly. </p>
<p>Iterate over a block of code and disassemble one instruction at a time</p>
<p>Determines size of instructions and then starts at the next one!</p>
<p>No regard for flow-control.</p>
<p>Data embedded within code chokes this algorithm.</p>
<p>Debuggers </p>
<p>Complete coverage over program's code sections.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              10/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-11">
          <div class="inner">
            
            <header><h1>Recursive Descent</h1></header>
            
            
            <section><p>Goes through linear flow while reading each instruction and building a list of locations to disassemble.</p>
<p>For each call, jump, etc, add destination to a list to disassemble.</p>
<ul>
<li>IE: Control Flow.  </li>
</ul>
<p>Stops parsing at a 'ret' or unconditional branch. </p>
<ul>
<li>Then take next location from list and continue</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              11/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-12">
          <div class="inner">
            
            <header><h1>Malware Analysis</h1></header>
            
            
            <section><p>Static and Dynamic approaches </p>
<p>Static</p>
<ul>
<li>Doesn't execute</li>
<li>Disassembly</li>
<li>Strings</li>
<li>Parsing file format</li>
</ul>
<p>Dynamic</p>
<ul>
<li>Execute</li>
<li>Running the binary</li>
<li>Debuggers</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              12/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-13">
          <div class="inner">
            
            <header><h1>Static</h1></header>
            
            
            <section><p>Does not require running the malware</p>
<p>Analyze the code and structure of a program</p>
<p>Antivirus / YARA</p>
<p>Hashing</p>
<p>Strings</p>
<p>Determining if file is packed</p>
<p>Viewing imports / exports</p>
<p>Disassemble </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              13/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-14">
          <div class="inner">
            
            <header><h1>Static</h1></header>
            
            
            <section><p>Some approaches useful to write YARA signatures.</p>
<p>Do not rely solely on output of strings, dependencies, etc.</p>
<p>Disassembly listings quite good, unless heavily obfuscated.  </p>
<p>Recall packers alter the structure of a binary </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              14/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-15">
          <div class="inner">
            
            <header><h1>Dynamic</h1></header>
            
            
            <section><p>Run the malware!</p>
<p>Requires a secure environment</p>
<p>Observe malware functionality </p>
<p>Run through a sandbox</p>
<p>Process Monitor</p>
<p>Procmon</p>
<p>Regshot</p>
<p>Fake a network (iNetSim/ApateDNS)</p>
<p>Wireshark</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              15/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-16">
          <div class="inner">
            
            <header><h1>Assembly Primer</h1></header>
            
            
            <section><p>IA32 / x86</p>
<ul>
<li>IDA Free only supports this</li>
</ul>
<h1>General Purpose Registers</h1>
<p>Small amount of data storage available on CPU
Quick access
8 General Purpose
Segment Registers
Status Register 
Instruction Pointer</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              16/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-17">
          <div class="inner">
            
            
            <section><p><img alt="registers" src="..\slideResources\malware\registers.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              17/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-18">
          <div class="inner">
            
            <header><h1>Instructions</h1></header>
            
            
            <section><p>Building blocks of assembly.</p>
<p>Consists of a mnemonic and zero or more operands.</p>
<p>Mnemonic</p>
<ul>
<li>Mov, Add, Sub, Ret</li>
</ul>
<p>Operands</p>
<ul>
<li>Source/Destination register, address, value</li>
</ul>
<p>Mov eax, 0x42</p>
<p>Turn into opcodes at time of assemble.</p>
<p>Little Endian. </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              18/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-19">
          <div class="inner">
            
            <header><h1>Operands</h1></header>
            
            
            <section><p>Immediate </p>
<ul>
<li>Fixed values such as 0x50</li>
</ul>
<p>Register</p>
<ul>
<li>EAX, EBX, etc</li>
</ul>
<p>Memory Address</p>
<ul>
<li>[EAX]</li>
</ul>
<p>IA32 uses Dst, Src </p>
<ul>
<li>Mov EAX, 0x50<ul>
<li>EAX is the destination of 0x50. </li>
</ul>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              19/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-20">
          <div class="inner">
            
            <header><h1>Stack Primer</h1></header>
            
            
            <section><p>LIFO Data Structure</p>
<p>Grows from high memory to low memory</p>
<p>Elements pushed onto the top of the stack and popped off the top of the stack.</p>
<p><img alt="stack" src="..\slideResources\malware\stack.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              20/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-21">
          <div class="inner">
            
            <header><h1>Function Primer</h1></header>
            
            
            <section><p>Most functions consist of a prologue and an epilogue</p>
<p>Prologue sets up the stack frame for the current function</p>
<div class="highlight"><pre><span class="nf">Push</span> <span class="nb">Ebp</span>
<span class="nf">Mov</span> <span class="nb">ebp</span><span class="p">,</span> <span class="nb">esp</span>
<span class="nf">Sub</span> <span class="nb">esp</span><span class="p">,</span> <span class="nb">si</span><span class="nv">zeOfLocalArgs</span>
</pre></div>

<p>Epilogue restores old stack pointers and returns to saved EIP before function call</p>
<div class="highlight"><pre><span class="nf">Mov</span> <span class="nb">esp</span><span class="p">,</span> <span class="nb">ebp</span>
<span class="nf">Pop</span> <span class="nb">ebp</span>
<span class="nf">ret</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              21/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-22">
          <div class="inner">
            
            <header><h1>Function Calls</h1></header>
            
            
            <section><p>Several calling conventions</p>
<p>Win32 uses stdcall</p>
<ul>
<li>passes arguments on the stack backwards.</li>
</ul>
<p>A call to a function foo with the arguments int x and int y</p>
<pre><code>foo(int x, int y)
</code></pre>
<p>would need to be passed on the stack as such</p>
<pre><code>push y
push x
</code></pre>
<p>Also the address of the next instruction after the call to foo will be pushed as the old EIP. </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              22/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-23">
          <div class="inner">
            
            <header><h1>Conditionals</h1></header>
            
            
            <section><p>Decisions based on comparisons</p>
<ul>
<li>C/Java/Whatever has IF, ELSE, WHILE, etc. </li>
</ul>
<p>Assembly has instructions to make comparsions</p>
<ul>
<li>Cmp, test . . .</li>
</ul>
<p>And instructions to branch</p>
<ul>
<li>
<p>Conditionally executed statement to control flow</p>
</li>
<li>
<p>Jmp, Jne, Jz, je. . .</p>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              23/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-24">
          <div class="inner">
            
            <header><h1>IDA</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              24/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-25">
          <div class="inner">
            
            <header><h1>IDA</h1></header>
            
            
            <section><p>Interactive Disassembler from Hex-Rays</p>
<p>Recursive descent Disassembler </p>
<p>As well as heuristics to find additional code not found during the algorithm.</p>
<p>Uses a working database </p>
<p>You are not modifying an executable when you make changes</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              25/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-26">
          <div class="inner">
            
            <header><h1>IDA Disassembly</h1></header>
            
            
            <section><p>F.L.I.R.T.</p>
<p>Fast Library Identification and Recognition Technology</p>
<p>IDA recognizes standard library functions generated by certain compilers. </p>
<p>Will parse through a binary using recursive descent and then apply key structs to the binary if they match.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              26/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-27">
          <div class="inner">
            
            <header><h1>F.L.I.R.T. Example</h1></header>
            
            
            <section><p><img alt="flirt" src="..\slideResources\malware\flirt.png" /></p>
<p>IDA matched two winAPI functions for manipulating the registry. </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              27/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-28">
          <div class="inner">
            
            <header><h1>Viewing Disassembly</h1></header>
            
            
            <section><p>sub_xxx </p>
<ul>
<li>Subroutine.</li>
</ul>
<p>loc_xxx</p>
<ul>
<li>Code at location xxx </li>
</ul>
<p>Byte, word, dword, etc_xxx</p>
<p>arg_xx</p>
<ul>
<li>Argument passed into function</li>
</ul>
<p>var_xx </p>
<ul>
<li>Local variable in a function</li>
<li>IDA tries to determine if the stack frame uses EBP</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              28/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-29">
          <div class="inner">
            
            <header><h1>Following Control Flow</h1></header>
            
            
            <section><p>Graph and Text mode.</p>
<ul>
<li>“Space” switches between them</li>
<li>In “IDA-View” window. </li>
</ul>
<p>Functions Window</p>
<ul>
<li>Shows start address</li>
</ul>
<p>Color band/navigation band</p>
<ul>
<li>Linear view of address space. </li>
<li>Dark blue is user-written code!</li>
<li>Light blue is library code recognized by FLIRT</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              29/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-30">
          <div class="inner">
            
            <header><h1>Control Flow/Branching</h1></header>
            
            
            <section><h1>On a comparison, such as JNZ...</h1>
<p>Green = Branch Taken / TRUE</p>
<p>Red = Branch Not taken / FALSE</p>
<p>Blue = Unconditional</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              30/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-31">
          <div class="inner">
            
            <header><h1>More</h1></header>
            
            
            <section><p>Imports/Exports Window</p>
<ul>
<li>Any imports or exports IDA finds it places into these windows.</li>
<li>Includes the virtual address or ordinal number.</li>
</ul>
<p>Strings</p>
<ul>
<li>Display for certain length and types</li>
</ul>
<p>Names Window</p>
<ul>
<li>Listing of the global names within a binary</li>
<li>Symbolic descriptions given to an address.<ul>
<li>Start, _Main</li>
</ul>
</li>
<li>“L” = Library</li>
<li>“F” = function</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              31/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-32">
          <div class="inner">
            
            <header><h1>Favorite Features</h1></header>
            
            
            <section><p>Xrefs</p>
<ul>
<li>“X”</li>
<li>Shows all references to a name/address/string/function, etc. </li>
</ul>
<p>Renaming functions</p>
<ul>
<li>“x”</li>
<li>Displays anywhere it is called</li>
</ul>
<p>Comments</p>
<ul>
<li>; and : to enter</li>
</ul>
<p>Edit function “Alt+P” </p>
<ul>
<li>IDA sometimes doesn't know what the stack frame looks like, this allows you to tell it.</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              32/33
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week04_01-MalwareAnalysis.md -->
      <div class="slide-wrapper">
        <div class="slide slide-33">
          <div class="inner">
            
            <header><h1>What you should use</h1></header>
            
            
            <section><p>Assembly is hard to learn</p>
<ul>
<li>Use “Auto Comments” to make it easier.</li>
</ul>
<p>Line Prefixes and Stack Pointer</p>
<ul>
<li>Not default on graph view, is on text view. </li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week04_01-MalwareAnalysis.md">week04_01-MalwareAnalysis.md</a>
            </aside>
            
            <aside class="page_number">
              33/33
            </aside>
          </footer>
        </div>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
      
      <tr id="toc-row-1">
        <th><a href="#slide1">Malware Analysis</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      
      
      <tr id="toc-row-2">
        <th><a href="#slide2">Resources</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      
      
      <tr id="toc-row-3">
        <th><a href="#slide3">Recall. . .</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      
      
      <tr id="toc-row-4">
        <th><a href="#slide4">Reverse Engineering</a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      
      
      <tr id="toc-row-5">
        <th><a href="#slide5">Compilation</a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
      
      
      <tr id="toc-row-6">
        <th><a href="#slide6">Disassembly</a></th>
        <td><a href="#slide6">6</a></td>
      </tr>
      
      
      <tr id="toc-row-7">
        <th><a href="#slide7">Disassembly</a></th>
        <td><a href="#slide7">7</a></td>
      </tr>
      
      
      <tr id="toc-row-8">
        <th><a href="#slide8">Example</a></th>
        <td><a href="#slide8">8</a></td>
      </tr>
      
      
      <tr id="toc-row-9">
        <th><a href="#slide9">Disassembly Algorithms</a></th>
        <td><a href="#slide9">9</a></td>
      </tr>
      
      
      <tr id="toc-row-10">
        <th><a href="#slide10">Linear Sweep</a></th>
        <td><a href="#slide10">10</a></td>
      </tr>
      
      
      <tr id="toc-row-11">
        <th><a href="#slide11">Recursive Descent</a></th>
        <td><a href="#slide11">11</a></td>
      </tr>
      
      
      <tr id="toc-row-12">
        <th><a href="#slide12">Malware Analysis</a></th>
        <td><a href="#slide12">12</a></td>
      </tr>
      
      
      <tr id="toc-row-13">
        <th><a href="#slide13">Static</a></th>
        <td><a href="#slide13">13</a></td>
      </tr>
      
      
      <tr id="toc-row-14">
        <th><a href="#slide14">Static</a></th>
        <td><a href="#slide14">14</a></td>
      </tr>
      
      
      <tr id="toc-row-15">
        <th><a href="#slide15">Dynamic</a></th>
        <td><a href="#slide15">15</a></td>
      </tr>
      
      
      <tr id="toc-row-16">
        <th><a href="#slide16">Assembly Primer</a></th>
        <td><a href="#slide16">16</a></td>
      </tr>
      
      
      <tr id="toc-row-17">
        <th><a href="#slide17">-</a></th>
        <td><a href="#slide17">17</a></td>
      </tr>
      
      
      <tr id="toc-row-18">
        <th><a href="#slide18">Instructions</a></th>
        <td><a href="#slide18">18</a></td>
      </tr>
      
      
      <tr id="toc-row-19">
        <th><a href="#slide19">Operands</a></th>
        <td><a href="#slide19">19</a></td>
      </tr>
      
      
      <tr id="toc-row-20">
        <th><a href="#slide20">Stack Primer</a></th>
        <td><a href="#slide20">20</a></td>
      </tr>
      
      
      <tr id="toc-row-21">
        <th><a href="#slide21">Function Primer</a></th>
        <td><a href="#slide21">21</a></td>
      </tr>
      
      
      <tr id="toc-row-22">
        <th><a href="#slide22">Function Calls</a></th>
        <td><a href="#slide22">22</a></td>
      </tr>
      
      
      <tr id="toc-row-23">
        <th><a href="#slide23">Conditionals</a></th>
        <td><a href="#slide23">23</a></td>
      </tr>
      
      
      <tr id="toc-row-24">
        <th><a href="#slide24">IDA</a></th>
        <td><a href="#slide24">24</a></td>
      </tr>
      
      
      <tr id="toc-row-25">
        <th><a href="#slide25">IDA</a></th>
        <td><a href="#slide25">25</a></td>
      </tr>
      
      
      <tr id="toc-row-26">
        <th><a href="#slide26">IDA Disassembly</a></th>
        <td><a href="#slide26">26</a></td>
      </tr>
      
      
      <tr id="toc-row-27">
        <th><a href="#slide27">F.L.I.R.T. Example</a></th>
        <td><a href="#slide27">27</a></td>
      </tr>
      
      
      <tr id="toc-row-28">
        <th><a href="#slide28">Viewing Disassembly</a></th>
        <td><a href="#slide28">28</a></td>
      </tr>
      
      
      <tr id="toc-row-29">
        <th><a href="#slide29">Following Control Flow</a></th>
        <td><a href="#slide29">29</a></td>
      </tr>
      
      
      <tr id="toc-row-30">
        <th><a href="#slide30">Control Flow/Branching</a></th>
        <td><a href="#slide30">30</a></td>
      </tr>
      
      
      <tr id="toc-row-31">
        <th><a href="#slide31">More</a></th>
        <td><a href="#slide31">31</a></td>
      </tr>
      
      
      <tr id="toc-row-32">
        <th><a href="#slide32">Favorite Features</a></th>
        <td><a href="#slide32">32</a></td>
      </tr>
      
      
      <tr id="toc-row-33">
        <th><a href="#slide33">What you should use</a></th>
        <td><a href="#slide33">33</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Exposé</th>
        <td>ESC</td>
      </tr>
      <tr>
        <th>Full screen slides</th>
        <td>e</td>
      </tr>
      <tr>
        <th>Presenter View</th>
        <td>p</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Toggle screen blanking</th>
        <td>b</td>
      </tr>
      <tr>
        <th>Show/hide slide context</th>
        <td>c</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
  </div>
  <script>main()</script>
</body>
</html>
