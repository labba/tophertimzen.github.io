<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Disk Artifacts in Memory</title>
    <!-- Styles -->
    
    <link rel="stylesheet" media="print" href="..\slideResources\theme\css\print.css">
    <link rel="stylesheet" media="screen, projection" href="..\slideResources\theme\css\screen.css">
    
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script type="text/javascript" src="..\slideResources\theme\js\slides.js"></script>
    
    
    
    <!-- /Javascripts -->
</head>
<body>
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-1">
          <div class="inner">
            
            <header><h1>Disk Artifacts in Memory</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              1/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-2">
          <div class="inner">
            
            <header><h1>What</h1></header>
            
            
            <section><p>New Technology File System (NTFS) artifacts</p>
<p>Master File Table (MTF) records</p>
<p>Alternative Data Streams (ADS) </p>
<p>Windows Cache Manager </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              2/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-3">
          <div class="inner">
            
            <header><h1>Why</h1></header>
            
            
            <section><p>OS is constantly opening, reading, writing and deleting files. </p>
<p>All OS actions leave traces in memory</p>
<p>Windows caches content for performance </p>
<ul>
<li>Lots of files in memory as disk read takes a lot of time</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              3/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-4">
          <div class="inner">
            
            <header><h1>NTFS Primer</h1></header>
            
            
            <section><p>Everything is a file</p>
<ul>
<li>Directories, files, bootstrap data, metadata...</li>
</ul>
<p>MFT is the heart of the system at \$Mft</p>
<p>start of MFT is in the Volume Boot Record (VBR)</p>
<p>VBR is the $Boot entry in the MFT</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              4/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-5">
          <div class="inner">
            
            <header><h1>NTFS Partition</h1></header>
            
            
            <section><p><img alt="" src="..\slideResources\diskArtifacts\ntfs.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              5/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-6">
          <div class="inner">
            
            <header><h1>MFT</h1></header>
            
            
            <section><p>Array of file records</p>
<p>Each record is 1024 bytes (can be changed in $Boot) </p>
<p>The first record in the MFT is for the MFT itself</p>
<p>The first 16 records in the MFT are reserved for metadata files</p>
<p>Each record has</p>
<ul>
<li>Attributes<ul>
<li>header and data</li>
</ul>
</li>
<li>entry header</li>
</ul>
<p>Resident attributes = contained within MFT entry</p>
<p>Non-resident = outside of the MFT entry </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              6/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-7">
          <div class="inner">
            
            <header><h1>MFT</h1></header>
            
            
            <section><p><img alt="" src="..\slideResources\diskArtifacts\mft.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              7/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-8">
          <div class="inner">
            
            <header><h1>Entry Layout</h1></header>
            
            
            <section><p><img alt="" src="..\slideResources\diskArtifacts\entryLayout.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              8/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-9">
          <div class="inner">
            
            <header><h1>Entry Header</h1></header>
            
            
            <section><pre><code>0x0     0 – 3   Signature (“FILE”) if good otherwise (“BAAD”)  
0x4     4 – 5   Offset to fixup array               
0x6     6 – 7   Number of entries in fixup array            
0x8     8 – 15  $LogFile LSN                
0x10    16 – 17 Sequence value              
0x12    18 – 19 Link Count              
0x14    20 – 21 Offset to first attribute           
0x16    22 – 23 Flags (in-use and directory)            
0x18    24 – 27 Used size of MFT entry          
0x1A    28 – 31 Allocated size of MFT entry         
0x20    32 – 39 File reference to base record           
0x28    40 – 41 Next attribute ID               
0x2A    42 – 1023   Attributes and fixup areas
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              9/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-10">
          <div class="inner">
            
            <header><h1>Attributes</h1></header>
            
            
            <section><pre><code>0x0     0 – 3   Attribute type identifier           
0x4     4 – 7   Length of attribute              
0x8     8 – 8   Non-resident flag                
0x9     9 – 9   Length of name               
0xA     10 – 11 Offset to name               
0xC     12 – 13 Flags                    
0xE     14 – 15 Attribute identifier
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              10/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-11">
          <div class="inner">
            
            <header><h1>Standard Attributes</h1></header>
            
            
            <section><p>16(0x10)    $STANDARD_INFORMATION</p>
<ul>
<li>Contains basic metadata for the dile or directory</li>
</ul>
<p>48(0x30)    $FILE_NAME</p>
<ul>
<li>File’s name and parent OR directory index</li>
</ul>
<p>128(0x80)   $DATA</p>
<ul>
<li>Raw content</li>
</ul>
<p>32(0x20)    $ATTRIBUTE_LIST</p>
<ul>
<li>Location of other attributes</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              11/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-12">
          <div class="inner">
            
            <header><h1>STANDARD_INFORMATION</h1></header>
            
            
            <section><p>Contains </p>
<ul>
<li>Creation time</li>
<li>File altered time</li>
<li>MFT altered time not shown in file properties</li>
<li>File accessed time</li>
<li>Flags (hidden, ro, directory, temp...)</li>
<li>Maximum number of versions</li>
<li>Version number</li>
<li>Class ID</li>
<li>Owner ID</li>
<li>Security ID</li>
<li>Quota charged</li>
<li>Update Sequence Number(USN)</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              12/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-13">
          <div class="inner">
            
            <header><h1>What to do with MFT?</h1></header>
            
            
            <section><p>Parse them</p>
<p>Investigation of removable media</p>
<p>Recover ADS</p>
<p>Recover scripts</p>
<p>Reconstruct events</p>
<p>Prove code executed with the Prefetch</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              13/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-14">
          <div class="inner">
            
            <header><h1>MFTParser</h1></header>
            
            
            <section><p>Scans for FILE and BAAD signatures</p>
<p>When found... parse the attributes, find file path, output. </p>
<p>Supports</p>
<ul>
<li>$FILE_NAME ($FN)  </li>
<li>$STANDARD_INFORMATION ($SI) </li>
<li>$DATA </li>
</ul>
<p>File size &lt; 700 bytes = resident in $DATA</p>
<p>File Size &gt; 700 bytes = dumpfiles </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              14/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-15">
          <div class="inner">
            
            <header><h1>MFTParser</h1></header>
            
            
            <section><p>Outputs in verbose and in body mode</p>
<p>Body mode allows sleuthkits mactime plugin to be used.</p>
<ul>
<li>
<p>mactime creates an ASCII timeline of file activity</p>
</li>
<li>
<p>-D dumps all resident files (size &lt; 700 bytes in $DATA)</p>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              15/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-16">
          <div class="inner">
            
            
            <section><div class="highlight"><pre>MFT entry found at offset 0x10097800
Attribute: In Use <span class="p">&amp;</span> File
Record Number: 9614
Link count: 2


<span class="nv">$STANDARD_INFORMATION</span>
Creation                       Modified                       MFT Altered                    Access Date                    Type
------------------------------ ------------------------------ ------------------------------ ------------------------------ ----
2009-07-13 22:28:34 UTC+0000 2009-07-13 22:28:34 UTC+0000   2011-03-04 17:15:16 UTC+0000   2009-07-13 22:28:34 UTC+0000   Archive

<span class="nv">$FILE_NAME</span>
Creation                       Modified                       MFT Altered                    Access Date                    Name/Path
------------------------------ ------------------------------ ------------------------------ ------------------------------ ---------
2011-03-04 17:15:16 UTC+0000 2011-03-04 17:15:16 UTC+0000   2011-03-04 17:15:16 UTC+0000   2011-03-04 17:15:16 UTC+0000   PROGRA~1<span class="se">\C</span>OMMON~1<span class="se">\M</span>ICROS~1<span class="se">\S</span>tationery<span class="se">\B</span>ears.htm

<span class="nv">$FILE_NAME</span>
Creation                       Modified                       MFT Altered                    Access Date                    Name/Path
------------------------------ ------------------------------ ------------------------------ ------------------------------ ---------
2011-03-04 17:15:16 UTC+0000 2011-03-04 17:15:16 UTC+0000   2011-03-04 17:15:16 UTC+0000   2011-03-04 17:15:16 UTC+0000   Bears.htm

<span class="nv">$DATA</span>
0000000000: 3c <span class="m">48</span> <span class="m">54</span> 4d 4c 3e 3c <span class="m">48</span> <span class="m">45</span> <span class="m">41</span> <span class="m">44</span> 3e 3c <span class="m">53</span> <span class="m">54</span> <span class="m">59</span>   &lt;HTML&gt;&lt;HEAD&gt;&lt;STY
0000000010: 4c <span class="m">45</span> 3e <span class="m">42</span> 4f <span class="m">44</span> <span class="m">59</span> <span class="m">20</span> 7b <span class="m">66</span> 6f 6e <span class="m">74</span> 2d <span class="m">66</span> <span class="m">61</span>   LE&gt;BODY.<span class="o">{</span>font-fa
0000000020: 6d <span class="m">69</span> 6c <span class="m">79</span> 3a <span class="m">20</span> <span class="m">54</span> <span class="m">61</span> <span class="m">68</span> 6f 6d <span class="m">61</span> 3b <span class="m">66</span> 6f 6e   mily:.Tahoma<span class="p">;</span>fon
0000000030: <span class="m">74</span> 2d <span class="m">73</span> <span class="m">69</span> 7a <span class="m">65</span> 3a <span class="m">20</span> <span class="m">31</span> <span class="m">31</span> <span class="m">70</span> <span class="m">74</span> 3b <span class="m">63</span> 6f 6c   t-size:.11pt<span class="p">;</span>col
0000000040: 6f <span class="m">72</span> 3a <span class="m">20</span> <span class="m">34</span> <span class="m">62</span> <span class="m">33</span> <span class="m">30</span> <span class="m">30</span> <span class="m">38</span> 3b 6d <span class="m">61</span> <span class="m">72</span> <span class="m">67</span> <span class="m">69</span>   or:.4b3008<span class="p">;</span>margi
0000000050: 6e 2d 6c <span class="m">65</span> <span class="m">66</span> <span class="m">74</span> 3a <span class="m">20</span> <span class="m">32</span> <span class="m">35</span> <span class="m">20</span> <span class="m">70</span> <span class="m">78</span> 3b 6d <span class="m">61</span>   n-left:.25.px<span class="p">;</span>ma
0000000060: <span class="m">72</span> <span class="m">67</span> <span class="m">69</span> 6e 2d <span class="m">74</span> 6f <span class="m">70</span> 3a <span class="m">20</span> <span class="m">37</span> <span class="m">35</span> <span class="m">20</span> <span class="m">70</span> <span class="m">78</span> 3b   rgin-top:.75.px<span class="p">;</span>
0000000070: <span class="m">62</span> <span class="m">61</span> <span class="m">63</span> 6b <span class="m">67</span> <span class="m">72</span> 6f <span class="m">75</span> 6e <span class="m">64</span> 2d <span class="m">70</span> 6f <span class="m">73</span> <span class="m">69</span> <span class="m">74</span>   background-posit
0000000080: <span class="m">69</span> 6f 6e 3a <span class="m">20</span> <span class="m">74</span> 6f <span class="m">70</span> <span class="m">20</span> 6c <span class="m">65</span> <span class="m">66</span> <span class="m">74</span> 3b <span class="m">62</span> <span class="m">61</span>   ion:.top.left<span class="p">;</span>ba
0000000090: <span class="m">63</span> 6b <span class="m">67</span> <span class="m">72</span> 6f <span class="m">75</span> 6e <span class="m">64</span> 2d <span class="m">72</span> <span class="m">65</span> <span class="m">70</span> <span class="m">65</span> <span class="m">61</span> <span class="m">74</span> 3a   ckground-repeat:
00000000a0: <span class="m">20</span> <span class="m">72</span> <span class="m">65</span> <span class="m">70</span> <span class="m">65</span> <span class="m">61</span> <span class="m">74</span> 2d <span class="m">78</span> 3b 7d 3c 2f <span class="m">53</span> <span class="m">54</span> <span class="m">59</span>   .repeat-x<span class="p">;</span><span class="o">}</span>&lt;/STY
00000000b0: 4c <span class="m">45</span> 3e 3c 2f <span class="m">48</span> <span class="m">45</span> <span class="m">41</span> <span class="m">44</span> 3e <span class="m">20</span> 3c <span class="m">42</span> 4f <span class="m">44</span> <span class="m">59</span>   LE&gt;&lt;/HEAD&gt;.&lt;BODY
00000000c0: <span class="m">20</span> <span class="m">62</span> <span class="m">61</span> <span class="m">63</span> 6b <span class="m">67</span> <span class="m">72</span> 6f <span class="m">75</span> 6e <span class="m">64</span> 3d <span class="m">22</span> <span class="m">42</span> <span class="m">65</span> <span class="m">61</span>   .background<span class="o">=</span><span class="s2">&quot;Bea</span>
<span class="s2">00000000d0: 72 73 2e 6a 70 67 22 3e 3c 42 4f 44 59 20 62 67   rs.jpg&quot;</span>&gt;&lt;BODY.bg
00000000e0: <span class="m">63</span> 6f 6c 6f <span class="m">72</span> 3d <span class="m">22</span> <span class="m">66</span> <span class="m">66</span> <span class="m">66</span> <span class="m">66</span> <span class="m">66</span> <span class="m">66</span> <span class="m">22</span> 3e 3c   <span class="nv">color</span><span class="o">=</span><span class="s2">&quot;ffffff&quot;</span>&gt;&lt;
00000000f0: 2f <span class="m">42</span> 4f <span class="m">44</span> <span class="m">59</span> 3e <span class="m">20</span> 3c 2f <span class="m">48</span> <span class="m">54</span> 4d 4c 3e <span class="m">20</span>      /BODY&gt;.&lt;/HTML&gt;.
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              16/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-17">
          <div class="inner">
            
            <header><h1>Alternative Data Streams</h1></header>
            
            
            <section><p>Normal data streams, also unnamed data streams, appear after $DATA.</p>
<ul>
<li>$DATA:""</li>
</ul>
<p>Alternative Data Streams</p>
<ul>
<li>$DATA:"NAME"</li>
</ul>
<p>Not easily visible by a user... cute way to hide data.</p>
<ul>
<li>Used legitimately though... IE Internet Zone appended to all downloadable files in ADS. </li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              17/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-18">
          <div class="inner">
            
            <header><h1>ADS</h1></header>
            
            
            <section><p>MFTParser will extract ADS if they exist</p>
<p>Directories can have ADS entries to hide files</p>
<p>In the below.. 613509021.exe would be hidden from the user in "Windows\1654157019"</p>
<p>Streams from SysInternals will show ADS on live system</p>
<div class="highlight"><pre>python vol.py –f Win7SP1x64.dmp --profile<span class="o">=</span>Win7SP1x64 mftparser
Volatility Foundation Volatility Framework 2.4
<span class="o">[</span>snip<span class="o">]</span>

MFT entry found at offset 0x1c02400
Attribute: In Use <span class="p">&amp;</span> File
Record Number: 19053

<span class="o">[</span>snip<span class="o">]</span>

<span class="nv">$FILE_NAME</span>
Creation: 2014-02-18 18:27:29 UTC+0000
Modified: 2014-02-18 18:27:29 UTC+0000
MFT Altered: 2014-02-18 18:27:29 UTC+0000
Access: 2014-02-18 18:27:29 UTC+0000
Name/Path: Windows<span class="se">\1</span>654157019
<span class="nv">$DATA</span>
<span class="nv">$DATA</span> ADS Name: 613509021.exe
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              18/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-19">
          <div class="inner">
            
            <header><h1>What Else?</h1></header>
            
            
            <section><p>$DATA ADS Name: 613509021.exe in Windows\1654157019</p>
<div class="highlight"><pre>python vol.py –f Win7SP1x64.dmp --profile<span class="o">=</span>Win7SP1x64 pslist
Volatility Foundation Volatility Framework 2.4
Name PID PPID Thds Hnds Sess Start
------------ ------ ------ ------ -------- ------ ------
<span class="o">[</span>snip<span class="o">]</span>
<span class="m">1654157019</span> <span class="m">3596</span> <span class="m">696</span> <span class="m">1</span> <span class="m">5</span> <span class="m">0</span> 2014-02-18 18:27:29 UTC+0000
<span class="o">[</span>snip<span class="o">]</span>


python vol.py –f Win7SP1x64.dmp --profile<span class="o">=</span>Win7SP1x64 dlllist -p 3596
Volatility Foundation Volatility Framework 2.4
************************************************************************
<span class="m">1654157019</span> pid: 3596
Command line : 1654157019:613509021.exe
Base Size LoadCount Path
---------- ---------- ---------- ----
0x00400000 0x330 0xffff C:<span class="se">\W</span>INDOWS<span class="se">\1</span>654157019:613509021.exe
</pre></div>

<p>So the file 1654157019 really appeared as 1654157019:613509021.exe using ADS name</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              19/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-20">
          <div class="inner">
            
            <header><h1>File Access</h1></header>
            
            
            <section><p>RecentDocs registry key </p>
<p>--output-file=mft.body</p>
<p>--output=body</p>
<div class="highlight"><pre><span class="p">[</span><span class="n">root</span><span class="o">&amp;</span><span class="n">windows</span><span class="p">]</span><span class="c">#volatility -f Win7.bin --profile=Win7SP0x86 mftparser --output-file=mft.body --output=body</span>
<span class="n">Volatility</span> <span class="n">Foundation</span> <span class="n">Volatility</span> <span class="n">Framework</span> <span class="mf">2.4</span>
<span class="n">Scanning</span> <span class="k">for</span> <span class="n">MFT</span> <span class="n">entries</span> <span class="ow">and</span> <span class="n">building</span> <span class="n">directory</span><span class="p">,</span> <span class="n">this</span> <span class="n">can</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span>

<span class="p">[</span><span class="n">root</span><span class="o">&amp;</span><span class="n">windows</span><span class="p">]</span><span class="c">#cat mft.body | head -n 10</span>
<span class="mi">0</span><span class="o">|</span><span class="p">[</span><span class="n">MFT</span> <span class="n">FILE_NAME</span><span class="p">]</span> <span class="err">$</span><span class="n">MFT</span> <span class="p">(</span><span class="n">Offset</span><span class="p">:</span> <span class="mh">0xa000</span><span class="p">)</span><span class="o">|</span><span class="mi">0</span><span class="o">|-</span><span class="n">hs</span><span class="o">------------|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">16384</span><span class="o">|</span><span class="mi">1299258843</span><span class="o">|</span><span class="mi">1299258843</span><span class="o">|</span><span class="mi">1299258843</span><span class="o">|</span><span class="mi">1299258843</span>
<span class="mi">0</span><span class="o">|</span><span class="p">[</span><span class="n">MFT</span> <span class="n">STD_INFO</span><span class="p">]</span> <span class="err">$</span><span class="n">MFT</span> <span class="p">(</span><span class="n">Offset</span><span class="p">:</span> <span class="mh">0xa000</span><span class="p">)</span><span class="o">|</span><span class="mi">0</span><span class="o">|-</span><span class="n">hs</span><span class="o">------------|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">16384</span><span class="o">|</span><span class="mi">1299258843</span><span class="o">|</span><span class="mi">1299258843</span><span class="o">|</span><span class="mi">1299258843</span><span class="o">|</span><span class="mi">1299258843</span>
<span class="mi">0</span><span class="o">|</span><span class="p">[</span><span class="n">MFT</span> <span class="n">FILE_NAME</span><span class="p">]</span> <span class="o">.</span> <span class="p">(</span><span class="n">Offset</span><span class="p">:</span> <span class="mh">0xa808</span><span class="p">)</span><span class="o">|</span><span class="mi">5</span><span class="o">|-</span><span class="n">hs</span><span class="o">----------</span><span class="n">D</span><span class="o">-|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">1299258843</span><span class="o">|</span><span class="mi">1299258843</span><span class="o">|</span><span class="mi">1299258843</span><span class="o">|</span><span class="mi">1299258843</span>
<span class="mi">0</span><span class="o">|</span><span class="p">[</span><span class="n">MFT</span> <span class="n">STD_INFO</span><span class="p">]</span> <span class="o">.</span> <span class="p">(</span><span class="n">Offset</span><span class="p">:</span> <span class="mh">0xa808</span><span class="p">)</span><span class="o">|</span><span class="mi">5</span><span class="o">|-</span><span class="n">hs</span><span class="o">------------|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">1381860262</span><span class="o">|</span><span class="mi">1381860262</span><span class="o">|</span><span class="mi">1381860262</span><span class="o">|</span><span class="mi">1247537274</span>
<span class="mi">0</span><span class="o">|</span><span class="p">[</span><span class="n">MFT</span> <span class="n">FILE_NAME</span><span class="p">]</span> <span class="n">bootmgr</span> <span class="p">(</span><span class="n">Offset</span><span class="p">:</span> <span class="mh">0xb408</span><span class="p">)</span><span class="o">|</span><span class="mi">42703</span><span class="o">|---</span><span class="n">a</span><span class="o">-----------|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">1299259135</span><span class="o">|</span><span class="mi">1299259135</span><span class="o">|</span><span class="mi">1299259135</span><span class="o">|</span><span class="mi">1299259135</span>
<span class="mi">0</span><span class="o">|</span><span class="p">[</span><span class="n">MFT</span> <span class="n">STD_INFO</span><span class="p">]</span> <span class="n">bootmgr</span> <span class="p">(</span><span class="n">Offset</span><span class="p">:</span> <span class="mh">0xb408</span><span class="p">)</span><span class="o">|</span><span class="mi">42703</span><span class="o">|</span><span class="n">rhsa</span><span class="o">-----------|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">1299259135</span><span class="o">|</span><span class="mi">1290288546</span><span class="o">|</span><span class="mi">1299259135</span><span class="o">|</span><span class="mi">1299259135</span>
<span class="mi">0</span><span class="o">|</span><span class="p">[</span><span class="n">MFT</span> <span class="n">FILE_NAME</span><span class="p">]</span> <span class="n">PROGRA</span><span class="o">~</span><span class="mi">2</span>\<span class="n">VMware</span>\<span class="n">RAWDSK</span><span class="o">~</span><span class="mi">1</span>\<span class="n">native</span>\<span class="n">C</span>\<span class="n">Windows</span> <span class="p">(</span><span class="n">Offset</span><span class="p">:</span> <span class="mh">0x160000</span><span class="p">)</span><span class="o">|</span><span class="mi">292</span><span class="o">|-----------</span><span class="n">I</span><span class="o">-</span><span class="n">D</span><span class="o">-|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">1341559419</span><span class="o">|</span><span class="mi">1341559419</span><span class="o">|</span><span class="mi">1341559419</span><span class="o">|</span><span class="mi">1341559419</span>
<span class="mi">0</span><span class="o">|</span><span class="p">[</span><span class="n">MFT</span> <span class="n">STD_INFO</span><span class="p">]</span> <span class="n">PROGRA</span><span class="o">~</span><span class="mi">2</span>\<span class="n">VMware</span>\<span class="n">RAWDSK</span><span class="o">~</span><span class="mi">1</span>\<span class="n">native</span>\<span class="n">C</span>\<span class="n">Windows</span> <span class="p">(</span><span class="n">Offset</span><span class="p">:</span> <span class="mh">0x160000</span><span class="p">)</span><span class="o">|</span><span class="mi">292</span><span class="o">|-----------</span><span class="n">I</span><span class="o">---|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">1341559419</span><span class="o">|</span><span class="mi">1341559419</span><span class="o">|</span><span class="mi">1341559419</span><span class="o">|</span><span class="mi">1341559419</span>
<span class="mi">0</span><span class="o">|</span><span class="p">[</span><span class="n">MFT</span> <span class="n">FILE_NAME</span><span class="p">]</span> <span class="n">PROGRA</span><span class="o">~</span><span class="mi">2</span>\<span class="n">MICROS</span><span class="o">~</span><span class="mi">1</span>\<span class="n">USERAC</span><span class="o">~</span><span class="mi">1</span> <span class="p">(</span><span class="n">Offset</span><span class="p">:</span> <span class="mh">0x160400</span><span class="p">)</span><span class="o">|</span><span class="mi">293</span><span class="o">|-----------</span><span class="n">I</span><span class="o">-</span><span class="n">D</span><span class="o">-|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">1299258912</span><span class="o">|</span><span class="mi">1299258912</span><span class="o">|</span><span class="mi">1299258912</span><span class="o">|</span><span class="mi">1299258912</span>
<span class="mi">0</span><span class="o">|</span><span class="p">[</span><span class="n">MFT</span> <span class="n">STD_INFO</span><span class="p">]</span> <span class="n">PROGRA</span><span class="o">~</span><span class="mi">2</span>\<span class="n">MICROS</span><span class="o">~</span><span class="mi">1</span>\<span class="n">USERAC</span><span class="o">~</span><span class="mi">1</span> <span class="p">(</span><span class="n">Offset</span><span class="p">:</span> <span class="mh">0x160400</span><span class="p">)</span><span class="o">|</span><span class="mi">293</span><span class="o">|-----------</span><span class="n">I</span><span class="o">---|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">1299249186</span><span class="o">|</span><span class="mi">1299249186</span><span class="o">|</span><span class="mi">1299249186</span><span class="o">|</span><span class="mi">1247539025</span>
</pre></div>

<p>Use mactime from Sleuthkit to build a timeline!</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
              <p>Remember MRU in Registry and double-clicking files creates a LNK</p>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              20/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-21">
          <div class="inner">
            
            <header><h1>Trashed Files</h1></header>
            
            
            <section><p>MFTParser in verbose mode will show $I information which contains metadata on </p>
<ul>
<li>deleted files</li>
<li>file size (5842)</li>
<li>path on disk</li>
<li>timestamp of deletion (00c3b478121ece01)</li>
</ul>
<p><br></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              21/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-22">
          <div class="inner">
            
            <header><h1>Trashed Files</h1></header>
            
            
            <section><div class="highlight"><pre><span class="err">$</span><span class="n">FILE_NAME</span>
<span class="n">Creation</span><span class="p">:</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">03</span><span class="o">-</span><span class="mi">11</span> <span class="mo">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">52</span> <span class="n">UTC</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">Modified</span><span class="p">:</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">03</span><span class="o">-</span><span class="mi">11</span> <span class="mo">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">52</span> <span class="n">UTC</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">MFT</span> <span class="n">Altered</span><span class="p">:</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">03</span><span class="o">-</span><span class="mi">11</span> <span class="mo">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">52</span> <span class="n">UTC</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">Access</span><span class="p">:</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">03</span><span class="o">-</span><span class="mi">11</span> <span class="mo">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">52</span> <span class="n">UTC</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">Name</span><span class="o">/</span><span class="n">Path</span><span class="p">:</span> <span class="err">$</span><span class="n">Recycle</span><span class="o">.</span><span class="n">Bin</span>\<span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">1133905431</span><span class="o">-</span><span class="mi">3037184594</span><span class="o">-</span>
<span class="mi">10822689</span><span class="o">-</span><span class="mi">1000</span>\<span class="err">$</span><span class="n">I2NGUYJ</span><span class="o">.</span><span class="n">docx</span>

<span class="err">$</span><span class="n">DATA</span>
<span class="mo">0000000000</span><span class="p">:</span> <span class="mo">01000000000000005</span><span class="mi">842000000000000</span> <span class="o">........</span><span class="n">XB</span><span class="o">......</span>
<span class="mo">0000000010</span><span class="p">:</span> <span class="mo">00</span><span class="n">c3b478121ece0143003a005c005500</span> <span class="o">...</span><span class="n">x</span><span class="o">....</span><span class="n">C</span><span class="o">.</span><span class="p">:</span><span class="o">.</span>\<span class="o">.</span><span class="n">U</span><span class="o">.</span>
<span class="mo">0000000020</span><span class="p">:</span> <span class="mi">73006500720073005</span><span class="n">c0041006e006400</span> <span class="n">s</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">s</span><span class="o">.</span>\<span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">d</span><span class="o">.</span>
<span class="mo">0000000030</span><span class="p">:</span> <span class="mi">7200650077005</span><span class="n">c004400650073006b00</span> <span class="n">r</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">w</span><span class="o">.</span>\<span class="o">.</span><span class="n">D</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">k</span><span class="o">.</span>
<span class="mo">0000000040</span><span class="p">:</span> <span class="mi">74006</span><span class="n">f0070005c004d00650072006700</span> <span class="n">t</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">p</span><span class="o">.</span>\<span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">g</span><span class="o">.</span>
<span class="mo">0000000050</span><span class="p">:</span> <span class="mi">65007200200055007000640061007400</span> <span class="n">e</span><span class="o">.</span><span class="n">r</span><span class="o">...</span><span class="n">U</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">t</span><span class="o">.</span>
<span class="mo">0000000060</span><span class="p">:</span> <span class="mf">65002e0064006</span><span class="n">f006300780000000000</span> <span class="n">e</span><span class="o">...</span><span class="n">d</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">.....</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              22/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-23">
          <div class="inner">
            
            <header><h1>Trashed Files Timestamp</h1></header>
            
            
            <section><p>$I has a timestamp... how to parse it?</p>
<p>Timestamp is 0x10-&gt;0x24 = 00c3b478121ece01</p>
<ol>
<li>volshell</li>
<li>import addrspace for BufferAddressSpace</li>
<li>Create a WinTimeStamp object</li>
<li>Output in correct time zine</li>
</ol></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              23/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-24">
          <div class="inner">
            
            <header><h1>With Volshell</h1></header>
            
            
            <section><div class="highlight"><pre><span class="p">[</span><span class="n">root</span><span class="o">&amp;</span><span class="n">windows</span><span class="p">]</span><span class="c">#python vol.py -f Win7SP1x64.vmem --profile=Win7SP1x64 volshell</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">volatility.addrspace</span> <span class="kn">as</span> <span class="nn">addrspace</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bufferas</span> <span class="o">=</span> <span class="n">addrspace</span><span class="o">.</span><span class="n">BufferAddressSpace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">,</span>
<span class="n">data</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\x00\xc3\xb4\x78\x12\x1e\xce\x01</span><span class="s">&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">itime</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="s">&quot;WinTimeStamp&quot;</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vm</span> <span class="o">=</span> <span class="n">bufferas</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">itime</span><span class="o">.</span><span class="n">is_utc</span> <span class="o">=</span> <span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">itime</span><span class="p">)</span>
<span class="s">&#39;2013-03-11 04:39:52 UTC+0000&#39;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              24/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-25">
          <div class="inner">
            
            <header><h1>Data Exfiltration and Execution using the Prefetch</h1></header>
            
            
            <section><p><br></p>
<p>Prefetch </p>
<ul>
<li>Speed up application startup process</li>
<li>Shows what applications recently ran on a system</li>
<li>Contain name of executive, all DLLs, how many times application was ran and last runtime. </li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              25/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-26">
          <div class="inner">
            
            <header><h1>Prefetch</h1></header>
            
            
            <section><div class="highlight"><pre><span class="o">[</span>root<span class="p">&amp;</span>windows<span class="o">]</span><span class="c">#grep -i &quot;.pf&quot; mft.body  | grep -i &quot;exe&quot; | cut -d\| -f2</span>
<span class="o">[</span>MFT FILE_NAME<span class="o">]</span> PROGRA~1<span class="se">\M</span>ICROS~1<span class="se">\W</span>indows<span class="se">\v</span>6.0A<span class="se">\b</span>in<span class="se">\p</span>vk2pfx.exe <span class="o">(</span>Offset: 0x71db000<span class="o">)</span>
<span class="o">[</span>MFT STD_INFO<span class="o">]</span> PROGRA~1<span class="se">\M</span>ICROS~1<span class="se">\W</span>indows<span class="se">\v</span>6.0A<span class="se">\b</span>in<span class="se">\p</span>vk2pfx.exe <span class="o">(</span>Offset: 0x71db000<span class="o">)</span>
<span class="o">[</span>MFT FILE_NAME<span class="o">]</span> Windows<span class="se">\P</span>refetch<span class="se">\V</span>SAENV.EXE-526F88E1.pf <span class="o">(</span>Offset: 0x8e40000<span class="o">)</span>
<span class="o">[</span>MFT FILE_NAME<span class="o">]</span> Windows<span class="se">\P</span>refetch<span class="se">\N</span>DP40-KB2840628-V2-X86.EXE-76109BE9.pf <span class="o">(</span>Offset: 0xf7c5400<span class="o">)</span>
<span class="o">[</span>MFT FILE_NAME<span class="o">]</span> Windows<span class="se">\P</span>refetch<span class="se">\S</span>ETUP.EXE-A99FE93A.pf <span class="o">(</span>Offset: 0xf7c5800<span class="o">)</span>
<span class="o">[</span>MFT FILE_NAME<span class="o">]</span> Windows<span class="se">\P</span>refetch<span class="se">\N</span>GEN.EXE-DEAF5A03.pf <span class="o">(</span>Offset: 0xf7c5c00<span class="o">)</span>
<span class="o">[</span>MFT FILE_NAME<span class="o">]</span> TsWpfWrp.exe <span class="o">(</span>Offset: 0x11060000<span class="o">)</span>
<span class="o">[</span>MFT FILE_NAME<span class="o">]</span> Windows<span class="se">\P</span>refetch<span class="se">\V</span>C_IA64RUNTIME.EXE-35FD2B16.pf <span class="o">(</span>Offset: 0x18b3d800<span class="o">)</span>
<span class="o">[</span>MFT FILE_NAME<span class="o">]</span> Windows<span class="se">\P</span>refetch<span class="se">\U</span>NLODCTR.EXE-2462BF52.pf <span class="o">(</span>Offset: 0x18b79c00<span class="o">)</span>
<span class="o">[</span>MFT FILE_NAME<span class="o">]</span> Windows<span class="se">\P</span>refetch<span class="se">\T</span>ASKHOST.EXE-437C05A8.pf <span class="o">(</span>Offset: 0x18c73000<span class="o">)</span>
</pre></div>

<p>Look for suspicious names... like MalwareAnalysis.docx.exe </p>
<p>Look for executables that are not common</p>
<p>Using Prefetch with mactime builds a timeline of execution! </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              26/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-27">
          <div class="inner">
            
            <header><h1>Scripts</h1></header>
            
            
            <section><p>Scripts are commonly &lt; 700 bytes so the whole thing would be MFT-resident. </p>
<p>MFTParser in verbose mode show $DATA</p>
<div class="highlight"><pre><span class="err">$</span><span class="n">DATA</span>
<span class="mh">0x00000000</span><span class="p">:</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">70</span> <span class="mi">65</span> <span class="mi">6</span><span class="n">e</span> <span class="mi">20</span> <span class="mi">36</span> <span class="mi">36</span> <span class="mi">2</span><span class="n">e</span> <span class="mi">33</span> <span class="mi">32</span> <span class="mi">2</span><span class="n">e</span> <span class="mi">31</span> <span class="mi">31</span> <span class="mi">39</span> <span class="mi">2</span><span class="n">e</span> <span class="mi">33</span> <span class="nb">open</span><span class="o">.</span><span class="mf">66.32</span><span class="o">.</span><span class="mf">119.3</span>
<span class="mh">0x00000010</span><span class="p">:</span> <span class="mi">38</span> <span class="mi">0</span><span class="n">d</span> <span class="mi">0</span><span class="n">a</span> <span class="mi">6</span><span class="n">a</span> <span class="mi">61</span> <span class="mi">63</span> <span class="mi">6</span><span class="n">b</span> <span class="mi">0</span><span class="n">d</span> <span class="mi">0</span><span class="n">a</span> <span class="mi">32</span> <span class="mi">61</span> <span class="mi">77</span> <span class="mi">65</span> <span class="mi">73</span> <span class="mi">30</span> <span class="mi">6</span><span class="n">d</span> <span class="mf">8.</span><span class="o">.</span><span class="n">jack</span><span class="o">..</span><span class="mi">2</span><span class="n">awes0m</span>
<span class="mh">0x00000020</span><span class="p">:</span> <span class="mi">65</span> <span class="mi">0</span><span class="n">d</span> <span class="mi">0</span><span class="n">a</span> <span class="mi">6</span><span class="n">c</span> <span class="mi">63</span> <span class="mi">64</span> <span class="mi">20</span> <span class="mi">63</span> <span class="mi">3</span><span class="n">a</span> <span class="mi">5</span><span class="n">c</span> <span class="mi">57</span> <span class="mi">49</span> <span class="mi">4</span><span class="n">e</span> <span class="mi">44</span> <span class="mi">4</span><span class="n">f</span> <span class="mi">57</span> <span class="n">e</span><span class="o">..</span><span class="n">lcd</span><span class="o">.</span><span class="n">c</span><span class="p">:</span>\<span class="n">WINDOW</span>
<span class="mh">0x00000030</span><span class="p">:</span> <span class="mi">53</span> <span class="mi">5</span><span class="n">c</span> <span class="mi">53</span> <span class="mi">79</span> <span class="mi">73</span> <span class="mi">74</span> <span class="mi">65</span> <span class="mi">6</span><span class="n">d</span> <span class="mi">33</span> <span class="mi">32</span> <span class="mi">5</span><span class="n">c</span> <span class="mi">73</span> <span class="mi">79</span> <span class="mi">73</span> <span class="mi">74</span> <span class="mi">65</span> <span class="n">S</span>\<span class="n">System32</span>\<span class="n">syste</span>
<span class="mh">0x00000040</span><span class="p">:</span> <span class="mi">6</span><span class="n">d</span> <span class="mi">73</span> <span class="mi">0</span><span class="n">d</span> <span class="mi">0</span><span class="n">a</span> <span class="mi">63</span> <span class="mi">64</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">2</span><span class="n">f</span> <span class="mi">68</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">6</span><span class="n">d</span> <span class="mi">65</span> <span class="mi">2</span><span class="n">f</span> <span class="mi">6</span><span class="n">a</span> <span class="mi">61</span> <span class="n">ms</span><span class="o">..</span><span class="n">cd</span><span class="o">../</span><span class="n">home</span><span class="o">/</span><span class="n">ja</span>
<span class="mh">0x00000050</span><span class="p">:</span> <span class="mi">63</span> <span class="mi">6</span><span class="n">b</span> <span class="mi">0</span><span class="n">d</span> <span class="mi">0</span><span class="n">a</span> <span class="mi">62</span> <span class="mi">69</span> <span class="mi">6</span><span class="n">e</span> <span class="mi">61</span> <span class="mi">72</span> <span class="mi">79</span> <span class="mi">0</span><span class="n">d</span> <span class="mi">0</span><span class="n">a</span> <span class="mi">6</span><span class="n">d</span> <span class="mi">70</span> <span class="mi">75</span> <span class="mi">74</span> <span class="n">ck</span><span class="o">..</span><span class="n">binary</span><span class="o">..</span><span class="n">mput</span>
<span class="mh">0x00000060</span><span class="p">:</span> <span class="mi">20</span> <span class="mi">22</span> <span class="mi">2</span><span class="n">a</span> <span class="mi">2</span><span class="n">e</span> <span class="mi">74</span> <span class="mi">78</span> <span class="mi">74</span> <span class="mi">22</span> <span class="mi">0</span><span class="n">d</span> <span class="mi">0</span><span class="n">a</span> <span class="mi">64</span> <span class="mi">69</span> <span class="mi">73</span> <span class="mi">63</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">6</span><span class="n">e</span> <span class="o">.</span><span class="s">&quot;*.txt&quot;</span><span class="o">..</span><span class="n">discon</span>
<span class="mh">0x00000070</span><span class="p">:</span> <span class="mi">6</span><span class="n">e</span> <span class="mi">65</span> <span class="mi">63</span> <span class="mi">74</span> <span class="mi">0</span><span class="n">d</span> <span class="mi">0</span><span class="n">a</span> <span class="mi">62</span> <span class="mi">79</span> <span class="mi">65</span> <span class="mi">0</span><span class="n">d</span> <span class="mi">0</span><span class="n">a</span> <span class="n">nect</span><span class="o">..</span><span class="n">bye</span><span class="o">..</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              27/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-28">
          <div class="inner">
            
            <header><h1>Timestomping the MFT</h1></header>
            
            
            <section><p>MFT timestamps can be manipulated</p>
<p>Programs to timestomp</p>
<ul>
<li>Show up in MFT </li>
<li>Prefetch created </li>
<li>Event logs still appear</li>
<li>Shimcache entries </li>
<li>MRU lists..</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              28/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-29">
          <div class="inner">
            
            <header><h1>Extracting Files</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              29/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-30">
          <div class="inner">
            
            <header><h1>Windows Cache Manager</h1></header>
            
            
            <section><p>Subsystem for caching support for file system drivers</p>
<p>Frequently accessed data is in memory to avoid disk reads</p>
<p>Utilizes memory manager for tasks</p>
<p>Maps views of files with memory manager section objects (memory-mapped files)</p>
<p>Caches data within Virtual Address Control Blocks (VACB) with a 256KB view of data </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              30/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-31">
          <div class="inner">
            
            <header><h1>Executable and Data Files</h1></header>
            
            
            <section><p>_FILE_OBJECT from executive </p>
<p>Pool tag scan, walk process-handle tables, VAD nodes . . .</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">dt</span><span class="p">(</span><span class="s">&quot;_FILE_OBJECT&quot;</span><span class="p">)</span>
 <span class="s">&#39;_FILE_OBJECT&#39;</span> <span class="p">(</span><span class="mi">128</span> <span class="nb">bytes</span><span class="p">)</span>
<span class="mh">0x0</span>   <span class="p">:</span> <span class="n">Type</span>                           <span class="p">[</span><span class="s">&#39;short&#39;</span><span class="p">]</span>
<span class="mh">0x2</span>   <span class="p">:</span> <span class="n">Size</span>                           <span class="p">[</span><span class="s">&#39;short&#39;</span><span class="p">]</span>
<span class="mh">0x4</span>   <span class="p">:</span> <span class="n">DeviceObject</span>                   <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_DEVICE_OBJECT&#39;</span><span class="p">]]</span>
<span class="mh">0x8</span>   <span class="p">:</span> <span class="n">Vpb</span>                            <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_VPB&#39;</span><span class="p">]]</span>
<span class="mh">0xc</span>   <span class="p">:</span> <span class="n">FsContext</span>                      <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x10</span>  <span class="p">:</span> <span class="n">FsContext2</span>                     <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x14</span>  <span class="p">:</span> <span class="n">SectionObjectPointer</span>           <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_SECTION_OBJECT_POINTERS&#39;</span><span class="p">]]</span> 
<span class="mh">0x18</span>  <span class="p">:</span> <span class="n">PrivateCacheMap</span>                <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x1c</span>  <span class="p">:</span> <span class="n">FinalStatus</span>                    <span class="p">[</span><span class="s">&#39;long&#39;</span><span class="p">]</span>
<span class="mh">0x20</span>  <span class="p">:</span> <span class="n">RelatedFileObject</span>              <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_FILE_OBJECT&#39;</span><span class="p">]]</span>
<span class="mh">0x24</span>  <span class="p">:</span> <span class="n">LockOperation</span>                  <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x25</span>  <span class="p">:</span> <span class="n">DeletePending</span>                  <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x26</span>  <span class="p">:</span> <span class="n">ReadAccess</span>                     <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x27</span>  <span class="p">:</span> <span class="n">WriteAccess</span>                    <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">DeleteAccess</span>                   <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x29</span>  <span class="p">:</span> <span class="n">SharedRead</span>                     <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x2a</span>  <span class="p">:</span> <span class="n">SharedWrite</span>                    <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x2b</span>  <span class="p">:</span> <span class="n">SharedDelete</span>                   <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x2c</span>  <span class="p">:</span> <span class="n">Flags</span>                          <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x30</span>  <span class="p">:</span> <span class="n">FileName</span>                       <span class="p">[</span><span class="s">&#39;_UNICODE_STRING&#39;</span><span class="p">]</span>
<span class="mh">0x38</span>  <span class="p">:</span> <span class="n">CurrentByteOffset</span>              <span class="p">[</span><span class="s">&#39;_LARGE_INTEGER&#39;</span><span class="p">]</span>
<span class="mh">0x40</span>  <span class="p">:</span> <span class="n">Waiters</span>                        <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x44</span>  <span class="p">:</span> <span class="n">Busy</span>                           <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x48</span>  <span class="p">:</span> <span class="n">LastLock</span>                       <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x4c</span>  <span class="p">:</span> <span class="n">Lock</span>                           <span class="p">[</span><span class="s">&#39;_KEVENT&#39;</span><span class="p">]</span>
<span class="mh">0x5c</span>  <span class="p">:</span> <span class="n">Event</span>                          <span class="p">[</span><span class="s">&#39;_KEVENT&#39;</span><span class="p">]</span>
<span class="mh">0x6c</span>  <span class="p">:</span> <span class="n">CompletionContext</span>              <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_IO_COMPLETION_CONTEXT&#39;</span><span class="p">]]</span>
<span class="mh">0x70</span>  <span class="p">:</span> <span class="n">IrpListLock</span>                    <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x74</span>  <span class="p">:</span> <span class="n">IrpList</span>                        <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x7c</span>  <span class="p">:</span> <span class="n">FileObjectExtension</span>            <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              31/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-32">
          <div class="inner">
            
            <header><h1>_SECTION_OBJECT_POINTERS</h1></header>
            
            
            <section><p>Memory manager and cache manager use this to store file mapping and ache information for a file stream</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">dt</span><span class="p">(</span><span class="s">&quot;_SECTION_OBJECT_POINTERS&quot;</span><span class="p">)</span>
 <span class="s">&#39;_SECTION_OBJECT_POINTERS&#39;</span> <span class="p">(</span><span class="mi">12</span> <span class="nb">bytes</span><span class="p">)</span>
<span class="mh">0x0</span>   <span class="p">:</span> <span class="n">DataSectionObject</span>              <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x4</span>   <span class="p">:</span> <span class="n">SharedCacheMap</span>                 <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x8</span>   <span class="p">:</span> <span class="n">ImageSectionObject</span>             <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
</pre></div>

<p>DataSectionObject = Data</p>
<p>ImageSectionObject = Executable </p>
<p>Both point to _CONTROL_AREA which goes to _SUBSECTION used by memory manager </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              32/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-33">
          <div class="inner">
            
            <header><h1>Memory</h1></header>
            
            
            <section><p><img alt="" src="..\slideResources\diskArtifacts\caching.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              33/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-34">
          <div class="inner">
            
            <header><h1>Shared Cached Files</h1></header>
            
            
            <section><p>SharedCacheMap in _SECTION_OBJECT_POINTERS points to _SHARED_CACHE_MAP</p>
<p><img alt="" src="..\slideResources\diskArtifacts\sharedCache.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              34/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-35">
          <div class="inner">
            
            <header><h1>Dumpfiles</h1></header>
            
            
            <section><p>Scans for _FILE_OBJECTS from process handle tables and VAD trees</p>
<div class="highlight"><pre><span class="o">[</span>root<span class="p">&amp;</span>windows<span class="o">]</span><span class="c">#mkdir dumpedFiles</span>
/bin/mkdir: created directory <span class="sb">`</span>dumpedFiles<span class="err">&#39;</span>
<span class="o">[</span>root<span class="p">&amp;</span>windows<span class="o">]</span><span class="c">#volatility -f Win7.bin --profile=Win7SP0x86 dumpfiles -D dumpedFiles/</span>
Volatility Foundation Volatility Framework 2.4
DataSectionObject 0x85908148   <span class="m">4</span>      <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume1<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\L</span>ogFiles<span class="se">\W</span>MI<span class="se">\R</span>tBackup<span class="se">\E</span>twRTDiagLog.etl
SharedCacheMap 0x85908148   <span class="m">4</span>      <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume1<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\L</span>ogFiles<span class="se">\W</span>MI<span class="se">\R</span>tBackup<span class="se">\E</span>twRTDiagLog.etl
DataSectionObject 0x851df248   <span class="m">4</span>      <span class="se">\D</span>evice<span class="se">\c</span>lfsKtmLog
<span class="o">[</span>snip<span class="o">]</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              35/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-36">
          <div class="inner">
            
            <header><h1>Filescan</h1></header>
            
            
            <section><p>Scans for file objects using pool tag scanning</p>
<h1>Finding MFT</h1>
<div class="highlight"><pre><span class="o">[</span>root<span class="p">&amp;</span>windows<span class="o">]</span><span class="c">#volatility -f Win7.bin --profile=Win7SP0x86 filescan | grep -i mft</span>
0x000000003ef23558      <span class="m">3</span>      <span class="m">0</span> RW-rwd <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume1<span class="se">\$</span>MftMirr
0x000000003ef25d28     <span class="m">13</span>      <span class="m">0</span> RW-rwd <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume1<span class="se">\$</span>Mft
0x000000003efbaa68     <span class="m">17</span>      <span class="m">0</span> RW-rwd <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume1<span class="se">\$</span>Mft

<span class="o">[</span>root<span class="p">&amp;</span>windows<span class="o">]</span><span class="c">#volatility -f Win7.bin --profile=Win7SP0x86 dumpfiles -D dumpedFiles/ -n -Q 0x000000003ef25d28</span>
Volatility Foundation Volatility Framework 2.4
DataSectionObject 0x3ef25d28   None   <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume1<span class="se">\$</span>Mft
SharedCacheMap 0x3ef25d28   None   <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume1<span class="se">\$</span>Mft
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              36/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-37">
          <div class="inner">
            
            <header><h1>Extracting Keys</h1></header>
            
            
            <section><p>Keys are in RAM while encryption is occuring..</p>
<ul>
<li>Privates and Publics</li>
</ul>
<p>aeskeyfind Locates scheduled 128-bit and 256-bit AES keys in MEMORY-IMAGE.</p>
<div class="highlight"><pre><span class="o">[</span>root<span class="p">&amp;</span>windows<span class="o">]</span><span class="c">#/opt/aeskeyfind/aeskeyfind  Win7.bin</span>
fece4febd7fd0b7b4bebda3239c28a81
5dcfc8255ed8bb69cdd2ea16c292f638
53228d50da3abbb9dc8fb6cd6aed0242
Keyfind progress: 100%

<span class="o">[</span>root<span class="p">&amp;</span>windows<span class="o">]</span><span class="c">#/opt/aeskeyfind/aeskeyfind  stuxnet.vmem</span>
000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f
Keyfind progress: 100%
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              37/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-38">
          <div class="inner">
            
            <header><h1>Extracting Keys</h1></header>
            
            
            <section><p>Several tools to extract keys from memory</p>
<p>Interrogate</p>
<ul>
<li>AES</li>
<li>TwoFish</li>
<li>Serpent</li>
<li>RSA</li>
</ul>
<p>Memory scary!</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              38/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-39">
          <div class="inner">
            
            <header><h1>Disk Encryption Artifacts</h1></header>
            
            
            <section><p>Master key is in memory</p>
<ul>
<li>Transparent, on-the-fly encryption </li>
</ul>
<p>Cached passwords are accessible</p>
<p>Commercial solutions for breaking disk encryption exist (Passware, Elcomsoft) but you can do the same with open source utilities</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              39/40
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week08-diskArtifacts.md -->
      <div class="slide-wrapper">
        <div class="slide slide-40">
          <div class="inner">
            
            <header><h1>EOF</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week08-diskArtifacts.md">week08-diskArtifacts.md</a>
            </aside>
            
            <aside class="page_number">
              40/40
            </aside>
          </footer>
        </div>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
      
      <tr id="toc-row-1">
        <th><a href="#slide1">Disk Artifacts in Memory</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      
      
      <tr id="toc-row-2">
        <th><a href="#slide2">What</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      
      
      <tr id="toc-row-3">
        <th><a href="#slide3">Why</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      
      
      <tr id="toc-row-4">
        <th><a href="#slide4">NTFS Primer</a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      
      
      <tr id="toc-row-5">
        <th><a href="#slide5">NTFS Partition</a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
      
      
      <tr id="toc-row-6">
        <th><a href="#slide6">MFT</a></th>
        <td><a href="#slide6">6</a></td>
      </tr>
      
      
      <tr id="toc-row-7">
        <th><a href="#slide7">MFT</a></th>
        <td><a href="#slide7">7</a></td>
      </tr>
      
      
      <tr id="toc-row-8">
        <th><a href="#slide8">Entry Layout</a></th>
        <td><a href="#slide8">8</a></td>
      </tr>
      
      
      <tr id="toc-row-9">
        <th><a href="#slide9">Entry Header</a></th>
        <td><a href="#slide9">9</a></td>
      </tr>
      
      
      <tr id="toc-row-10">
        <th><a href="#slide10">Attributes</a></th>
        <td><a href="#slide10">10</a></td>
      </tr>
      
      
      <tr id="toc-row-11">
        <th><a href="#slide11">Standard Attributes</a></th>
        <td><a href="#slide11">11</a></td>
      </tr>
      
      
      <tr id="toc-row-12">
        <th><a href="#slide12">STANDARD_INFORMATION</a></th>
        <td><a href="#slide12">12</a></td>
      </tr>
      
      
      <tr id="toc-row-13">
        <th><a href="#slide13">What to do with MFT?</a></th>
        <td><a href="#slide13">13</a></td>
      </tr>
      
      
      <tr id="toc-row-14">
        <th><a href="#slide14">MFTParser</a></th>
        <td><a href="#slide14">14</a></td>
      </tr>
      
      
      <tr id="toc-row-15">
        <th><a href="#slide15">MFTParser</a></th>
        <td><a href="#slide15">15</a></td>
      </tr>
      
      
      <tr id="toc-row-16">
        <th><a href="#slide16">-</a></th>
        <td><a href="#slide16">16</a></td>
      </tr>
      
      
      <tr id="toc-row-17">
        <th><a href="#slide17">Alternative Data Streams</a></th>
        <td><a href="#slide17">17</a></td>
      </tr>
      
      
      <tr id="toc-row-18">
        <th><a href="#slide18">ADS</a></th>
        <td><a href="#slide18">18</a></td>
      </tr>
      
      
      <tr id="toc-row-19">
        <th><a href="#slide19">What Else?</a></th>
        <td><a href="#slide19">19</a></td>
      </tr>
      
      
      <tr id="toc-row-20">
        <th><a href="#slide20">File Access</a></th>
        <td><a href="#slide20">20</a></td>
      </tr>
      
      
      <tr id="toc-row-21">
        <th><a href="#slide21">Trashed Files</a></th>
        <td><a href="#slide21">21</a></td>
      </tr>
      
      
      <tr id="toc-row-22">
        <th><a href="#slide22">Trashed Files</a></th>
        <td><a href="#slide22">22</a></td>
      </tr>
      
      
      <tr id="toc-row-23">
        <th><a href="#slide23">Trashed Files Timestamp</a></th>
        <td><a href="#slide23">23</a></td>
      </tr>
      
      
      <tr id="toc-row-24">
        <th><a href="#slide24">With Volshell</a></th>
        <td><a href="#slide24">24</a></td>
      </tr>
      
      
      <tr id="toc-row-25">
        <th><a href="#slide25">Data Exfiltration and Execution using the Prefetch</a></th>
        <td><a href="#slide25">25</a></td>
      </tr>
      
      
      <tr id="toc-row-26">
        <th><a href="#slide26">Prefetch</a></th>
        <td><a href="#slide26">26</a></td>
      </tr>
      
      
      <tr id="toc-row-27">
        <th><a href="#slide27">Scripts</a></th>
        <td><a href="#slide27">27</a></td>
      </tr>
      
      
      <tr id="toc-row-28">
        <th><a href="#slide28">Timestomping the MFT</a></th>
        <td><a href="#slide28">28</a></td>
      </tr>
      
      
      <tr id="toc-row-29">
        <th><a href="#slide29">Extracting Files</a></th>
        <td><a href="#slide29">29</a></td>
      </tr>
      
      
      <tr id="toc-row-30">
        <th><a href="#slide30">Windows Cache Manager</a></th>
        <td><a href="#slide30">30</a></td>
      </tr>
      
      
      <tr id="toc-row-31">
        <th><a href="#slide31">Executable and Data Files</a></th>
        <td><a href="#slide31">31</a></td>
      </tr>
      
      
      <tr id="toc-row-32">
        <th><a href="#slide32">_SECTION_OBJECT_POINTERS</a></th>
        <td><a href="#slide32">32</a></td>
      </tr>
      
      
      <tr id="toc-row-33">
        <th><a href="#slide33">Memory</a></th>
        <td><a href="#slide33">33</a></td>
      </tr>
      
      
      <tr id="toc-row-34">
        <th><a href="#slide34">Shared Cached Files</a></th>
        <td><a href="#slide34">34</a></td>
      </tr>
      
      
      <tr id="toc-row-35">
        <th><a href="#slide35">Dumpfiles</a></th>
        <td><a href="#slide35">35</a></td>
      </tr>
      
      
      <tr id="toc-row-36">
        <th><a href="#slide36">Filescan</a></th>
        <td><a href="#slide36">36</a></td>
      </tr>
      
      
      <tr id="toc-row-37">
        <th><a href="#slide37">Extracting Keys</a></th>
        <td><a href="#slide37">37</a></td>
      </tr>
      
      
      <tr id="toc-row-38">
        <th><a href="#slide38">Extracting Keys</a></th>
        <td><a href="#slide38">38</a></td>
      </tr>
      
      
      <tr id="toc-row-39">
        <th><a href="#slide39">Disk Encryption Artifacts</a></th>
        <td><a href="#slide39">39</a></td>
      </tr>
      
      
      <tr id="toc-row-40">
        <th><a href="#slide40">EOF</a></th>
        <td><a href="#slide40">40</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Exposé</th>
        <td>ESC</td>
      </tr>
      <tr>
        <th>Full screen slides</th>
        <td>e</td>
      </tr>
      <tr>
        <th>Presenter View</th>
        <td>p</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Toggle screen blanking</th>
        <td>b</td>
      </tr>
      <tr>
        <th>Show/hide slide context</th>
        <td>c</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
  </div>
  <script>main()</script>
</body>
</html>
