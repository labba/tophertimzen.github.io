<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Malware</title>
    <!-- Styles -->
    
    <link rel="stylesheet" media="print" href="..\slideResources\theme\css\print.css">
    <link rel="stylesheet" media="screen, projection" href="..\slideResources\theme\css\screen.css">
    
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script type="text/javascript" src="..\slideResources\theme\js\slides.js"></script>
    
    
    
    <!-- /Javascripts -->
</head>
<body>
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-1">
          <div class="inner">
            
            <header><h1>Malware</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              1/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-2">
          <div class="inner">
            
            <header><h1>Obligatory Disclaimer</h1></header>
            
            
            <section><h1>Everything here is dual use</h1>
<h1>Learn about malware, malware techniques, etc. . .</h1></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              2/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-3">
          <div class="inner">
            
            <header><h1>Process Environment Block (PEB)</h1></header>
            
            
            <section><p>All processes contain a PEB from _EPROCESS</p>
<ul>
<li>Win32 at [FS:30h]</li>
<li>Win64 at [GS:60h]</li>
<li>Contains full path to executable</li>
</ul>
<p>Full command line and arguments</p>
<p>Working Directory</p>
<p>Process Heaps</p>
<p>Standard handles (Stdin/out/err)</p>
<p>Loaded DLLs (_PEB_LDR_DATA)</p>
<p>Exists in user space</p>
<p>Easily modifiable</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              3/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-4">
          <div class="inner">
            
            <header><h1>PEB</h1></header>
            
            
            <section><p>OS Version Information</p>
<p>Process Creation Flags</p>
<p>BeingDebugged</p>
<p>ImageBaseAddress</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              4/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-5">
          <div class="inner">
            
            <header><h1>_PEB</h1></header>
            
            
            <section><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">dt</span> <span class="p">(</span><span class="s">&quot;_PEB&quot;</span><span class="p">)</span>
 <span class="s">&#39;_PEB&#39;</span> <span class="p">(</span><span class="mi">584</span> <span class="nb">bytes</span><span class="p">)</span>
<span class="mh">0x0</span>   <span class="p">:</span> <span class="n">InheritedAddressSpace</span>          <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x1</span>   <span class="p">:</span> <span class="n">ReadImageFileExecOptions</span>       <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x2</span>   <span class="p">:</span> <span class="n">BeingDebugged</span>                  <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">BitField</span>                       <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span><span class="n">h</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">ImageUsesLargePages</span>            <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned char&#39;</span><span class="p">}]</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">IsImageDynamicallyRelocated</span>    <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned char&#39;</span><span class="p">}]</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">IsLegacyProcess</span>                <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned char&#39;</span><span class="p">}]</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">IsProtectedProcess</span>             <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned char&#39;</span><span class="p">}]</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">SkipPatchingUser32Forwarders</span>   <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned char&#39;</span><span class="p">}]</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">SpareBits</span>                      <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned char&#39;</span><span class="p">}]</span>
<span class="mh">0x4</span>   <span class="p">:</span> <span class="n">Mutant</span>                         <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x8</span>   <span class="p">:</span> <span class="n">ImageBaseAddress</span>               <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0xc</span>   <span class="p">:</span> <span class="n">Ldr</span>                            <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_PEB_LDR_DATA&#39;</span><span class="p">]]</span>
<span class="mh">0x10</span>  <span class="p">:</span> <span class="n">ProcessParameters</span>              <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_RTL_USER_PROCESS_PARAMETERS&#39;</span><span class="p">]]</span>
<span class="mh">0x14</span>  <span class="p">:</span> <span class="n">SubSystemData</span>                  <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x18</span>  <span class="p">:</span> <span class="n">ProcessHeap</span>                    <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x1c</span>  <span class="p">:</span> <span class="n">FastPebLock</span>                    <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_RTL_CRITICAL_SECTION&#39;</span><span class="p">]]</span>
<span class="mh">0x20</span>  <span class="p">:</span> <span class="n">AtlThunkSListPtr</span>               <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x24</span>  <span class="p">:</span> <span class="n">IFEOKey</span>                        <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">CrossProcessFlags</span>              <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ProcessInJob</span>                   <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned long&#39;</span><span class="p">}]</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ProcessInitializing</span>            <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned long&#39;</span><span class="p">}]</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ProcessUsingFTH</span>                <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned long&#39;</span><span class="p">}]</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ProcessUsingVCH</span>                <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned long&#39;</span><span class="p">}]</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ProcessUsingVEH</span>                <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned long&#39;</span><span class="p">}]</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ReservedBits0</span>                  <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned long&#39;</span><span class="p">}]</span>
<span class="mh">0x2c</span>  <span class="p">:</span> <span class="n">KernelCallbackTable</span>            <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x2c</span>  <span class="p">:</span> <span class="n">UserSharedInfoPtr</span>              <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x30</span>  <span class="p">:</span> <span class="n">SystemReserved</span>                 <span class="p">[</span><span class="s">&#39;array&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]]</span>
<span class="mh">0x34</span>  <span class="p">:</span> <span class="n">AtlThunkSListPtr32</span>             <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x38</span>  <span class="p">:</span> <span class="n">ApiSetMap</span>                      <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x3c</span>  <span class="p">:</span> <span class="n">TlsExpansionCounter</span>            <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x40</span>  <span class="p">:</span> <span class="n">TlsBitmap</span>                      <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x44</span>  <span class="p">:</span> <span class="n">TlsBitmapBits</span>                  <span class="p">[</span><span class="s">&#39;array&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]]</span>
<span class="mh">0x4c</span>  <span class="p">:</span> <span class="n">ReadOnlySharedMemoryBase</span>       <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x50</span>  <span class="p">:</span> <span class="n">HotpatchInformation</span>            <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x54</span>  <span class="p">:</span> <span class="n">ReadOnlyStaticServerData</span>       <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]]</span>
<span class="mh">0x58</span>  <span class="p">:</span> <span class="n">AnsiCodePageData</span>               <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x5c</span>  <span class="p">:</span> <span class="n">OemCodePageData</span>                <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x60</span>  <span class="p">:</span> <span class="n">UnicodeCaseTableData</span>           <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x64</span>  <span class="p">:</span> <span class="n">NumberOfProcessors</span>             <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x68</span>  <span class="p">:</span> <span class="n">NtGlobalFlag</span>                   <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x70</span>  <span class="p">:</span> <span class="n">CriticalSectionTimeout</span>         <span class="p">[</span><span class="s">&#39;_LARGE_INTEGER&#39;</span><span class="p">]</span>
<span class="mh">0x78</span>  <span class="p">:</span> <span class="n">HeapSegmentReserve</span>             <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x7c</span>  <span class="p">:</span> <span class="n">HeapSegmentCommit</span>              <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x80</span>  <span class="p">:</span> <span class="n">HeapDeCommitTotalFreeThreshold</span> <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x84</span>  <span class="p">:</span> <span class="n">HeapDeCommitFreeBlockThreshold</span> <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x88</span>  <span class="p">:</span> <span class="n">NumberOfHeaps</span>                  <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x8c</span>  <span class="p">:</span> <span class="n">MaximumNumberOfHeaps</span>           <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x90</span>  <span class="p">:</span> <span class="n">ProcessHeaps</span>                   <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;array&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">function</span> <span class="o">&lt;</span><span class="k">lambda</span><span class="o">&gt;</span> <span class="n">at</span> <span class="mh">0x93fa534</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_HEAP&#39;</span><span class="p">]]]]</span>
<span class="mh">0x94</span>  <span class="p">:</span> <span class="n">GdiSharedHandleTable</span>           <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x98</span>  <span class="p">:</span> <span class="n">ProcessStarterHelper</span>           <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x9c</span>  <span class="p">:</span> <span class="n">GdiDCAttributeList</span>             <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0xa0</span>  <span class="p">:</span> <span class="n">LoaderLock</span>                     <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_RTL_CRITICAL_SECTION&#39;</span><span class="p">]]</span>
<span class="mh">0xa4</span>  <span class="p">:</span> <span class="n">OSMajorVersion</span>                 <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0xa8</span>  <span class="p">:</span> <span class="n">OSMinorVersion</span>                 <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0xac</span>  <span class="p">:</span> <span class="n">OSBuildNumber</span>                  <span class="p">[</span><span class="s">&#39;unsigned short&#39;</span><span class="p">]</span>
<span class="mh">0xae</span>  <span class="p">:</span> <span class="n">OSCSDVersion</span>                   <span class="p">[</span><span class="s">&#39;unsigned short&#39;</span><span class="p">]</span>
<span class="mh">0xb0</span>  <span class="p">:</span> <span class="n">OSPlatformId</span>                   <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0xb4</span>  <span class="p">:</span> <span class="n">ImageSubsystem</span>                 <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0xb8</span>  <span class="p">:</span> <span class="n">ImageSubsystemMajorVersion</span>     <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0xbc</span>  <span class="p">:</span> <span class="n">ImageSubsystemMinorVersion</span>     <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0xc0</span>  <span class="p">:</span> <span class="n">ActiveProcessAffinityMask</span>      <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0xc4</span>  <span class="p">:</span> <span class="n">GdiHandleBuffer</span>                <span class="p">[</span><span class="s">&#39;array&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]]</span>
<span class="mh">0x14c</span> <span class="p">:</span> <span class="n">PostProcessInitRoutine</span>         <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x150</span> <span class="p">:</span> <span class="n">TlsExpansionBitmap</span>             <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x154</span> <span class="p">:</span> <span class="n">TlsExpansionBitmapBits</span>         <span class="p">[</span><span class="s">&#39;array&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]]</span>
<span class="mh">0x1d4</span> <span class="p">:</span> <span class="n">SessionId</span>                      <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x1d8</span> <span class="p">:</span> <span class="n">AppCompatFlags</span>                 <span class="p">[</span><span class="s">&#39;_ULARGE_INTEGER&#39;</span><span class="p">]</span>
<span class="mh">0x1e0</span> <span class="p">:</span> <span class="n">AppCompatFlagsUser</span>             <span class="p">[</span><span class="s">&#39;_ULARGE_INTEGER&#39;</span><span class="p">]</span>
<span class="mh">0x1e8</span> <span class="p">:</span> <span class="n">pShimData</span>                      <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x1ec</span> <span class="p">:</span> <span class="n">AppCompatInfo</span>                  <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x1f0</span> <span class="p">:</span> <span class="n">CSDVersion</span>                     <span class="p">[</span><span class="s">&#39;_UNICODE_STRING&#39;</span><span class="p">]</span>
<span class="mh">0x1f8</span> <span class="p">:</span> <span class="n">ActivationContextData</span>          <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_ACTIVATION_CONTEXT_DATA&#39;</span><span class="p">]]</span>
<span class="mh">0x1fc</span> <span class="p">:</span> <span class="n">ProcessAssemblyStorageMap</span>      <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_ASSEMBLY_STORAGE_MAP&#39;</span><span class="p">]]</span>
<span class="mh">0x200</span> <span class="p">:</span> <span class="n">SystemDefaultActivationContextData</span> <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_ACTIVATION_CONTEXT_DATA&#39;</span><span class="p">]]</span>
<span class="mh">0x204</span> <span class="p">:</span> <span class="n">SystemAssemblyStorageMap</span>       <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_ASSEMBLY_STORAGE_MAP&#39;</span><span class="p">]]</span>
<span class="mh">0x208</span> <span class="p">:</span> <span class="n">MinimumStackCommit</span>             <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x20c</span> <span class="p">:</span> <span class="n">FlsCallback</span>                    <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_FLS_CALLBACK_INFO&#39;</span><span class="p">]]</span>
<span class="mh">0x210</span> <span class="p">:</span> <span class="n">FlsListHead</span>                    <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x218</span> <span class="p">:</span> <span class="n">FlsBitmap</span>                      <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x21c</span> <span class="p">:</span> <span class="n">FlsBitmapBits</span>                  <span class="p">[</span><span class="s">&#39;array&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]]</span>
<span class="mh">0x22c</span> <span class="p">:</span> <span class="n">FlsHighIndex</span>                   <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x230</span> <span class="p">:</span> <span class="n">WerRegistrationData</span>            <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x234</span> <span class="p">:</span> <span class="n">WerShipAssertPtr</span>               <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x238</span> <span class="p">:</span> <span class="n">pContextData</span>                   <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x23c</span> <span class="p">:</span> <span class="n">pImageHeaderHash</span>               <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x240</span> <span class="p">:</span> <span class="n">CritSecTracingEnabled</span>          <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned long&#39;</span><span class="p">}]</span>
<span class="mh">0x240</span> <span class="p">:</span> <span class="n">HeapTracingEnabled</span>             <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned long&#39;</span><span class="p">}]</span>
<span class="mh">0x240</span> <span class="p">:</span> <span class="n">SpareTracingBits</span>               <span class="p">[</span><span class="s">&#39;BitField&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;end_bit&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s">&#39;start_bit&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;native_type&#39;</span><span class="p">:</span> <span class="s">&#39;unsigned long&#39;</span><span class="p">}]</span>
<span class="mh">0x240</span> <span class="p">:</span> <span class="n">TracingFlags</span>                   <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              5/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-6">
          <div class="inner">
            
            <header><h1>_RTL_USER_PROCESS_PARAMETERS</h1></header>
            
            
            <section><p>Std{In,Out,Err}</p>
<p>ImagePathName is full</p>
<ul>
<li>_EPROCESS.ImageFileName is 16 chars</li>
</ul>
<p>Command Line Args</p>
<p>Environmental Variables</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">dt</span><span class="p">(</span><span class="s">&quot;_RTL_USER_PROCESS_PARAMETERS&quot;</span><span class="p">)</span>
 <span class="s">&#39;_RTL_USER_PROCESS_PARAMETERS&#39;</span> <span class="p">(</span><span class="mi">664</span> <span class="nb">bytes</span><span class="p">)</span>
<span class="mh">0x0</span>   <span class="p">:</span> <span class="n">MaximumLength</span>                  <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x4</span>   <span class="p">:</span> <span class="n">Length</span>                         <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x8</span>   <span class="p">:</span> <span class="n">Flags</span>                          <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0xc</span>   <span class="p">:</span> <span class="n">DebugFlags</span>                     <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x10</span>  <span class="p">:</span> <span class="n">ConsoleHandle</span>                  <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x14</span>  <span class="p">:</span> <span class="n">ConsoleFlags</span>                   <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x18</span>  <span class="p">:</span> <span class="n">StandardInput</span>                  <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x1c</span>  <span class="p">:</span> <span class="n">StandardOutput</span>                 <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x20</span>  <span class="p">:</span> <span class="ne">StandardError</span>                  <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x24</span>  <span class="p">:</span> <span class="n">CurrentDirectory</span>               <span class="p">[</span><span class="s">&#39;_CURDIR&#39;</span><span class="p">]</span>
<span class="mh">0x30</span>  <span class="p">:</span> <span class="n">DllPath</span>                        <span class="p">[</span><span class="s">&#39;_UNICODE_STRING&#39;</span><span class="p">]</span>
<span class="mh">0x38</span>  <span class="p">:</span> <span class="n">ImagePathName</span>                  <span class="p">[</span><span class="s">&#39;_UNICODE_STRING&#39;</span><span class="p">]</span>
<span class="mh">0x40</span>  <span class="p">:</span> <span class="n">CommandLine</span>                    <span class="p">[</span><span class="s">&#39;_UNICODE_STRING&#39;</span><span class="p">]</span>
<span class="mh">0x48</span>  <span class="p">:</span> <span class="n">Environment</span>                    <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x4c</span>  <span class="p">:</span> <span class="n">StartingX</span>                      <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x50</span>  <span class="p">:</span> <span class="n">StartingY</span>                      <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x54</span>  <span class="p">:</span> <span class="n">CountX</span>                         <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x58</span>  <span class="p">:</span> <span class="n">CountY</span>                         <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x5c</span>  <span class="p">:</span> <span class="n">CountCharsX</span>                    <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x60</span>  <span class="p">:</span> <span class="n">CountCharsY</span>                    <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x64</span>  <span class="p">:</span> <span class="n">FillAttribute</span>                  <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x68</span>  <span class="p">:</span> <span class="n">WindowFlags</span>                    <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x6c</span>  <span class="p">:</span> <span class="n">ShowWindowFlags</span>                <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x70</span>  <span class="p">:</span> <span class="n">WindowTitle</span>                    <span class="p">[</span><span class="s">&#39;_UNICODE_STRING&#39;</span><span class="p">]</span>
<span class="mh">0x78</span>  <span class="p">:</span> <span class="n">DesktopInfo</span>                    <span class="p">[</span><span class="s">&#39;_UNICODE_STRING&#39;</span><span class="p">]</span>
<span class="mh">0x80</span>  <span class="p">:</span> <span class="n">ShellInfo</span>                      <span class="p">[</span><span class="s">&#39;_UNICODE_STRING&#39;</span><span class="p">]</span>
<span class="mh">0x88</span>  <span class="p">:</span> <span class="n">RuntimeData</span>                    <span class="p">[</span><span class="s">&#39;_UNICODE_STRING&#39;</span><span class="p">]</span>
<span class="mh">0x90</span>  <span class="p">:</span> <span class="n">CurrentDirectores</span>              <span class="p">[</span><span class="s">&#39;array&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_RTL_DRIVE_LETTER_CURDIR&#39;</span><span class="p">]]</span>
<span class="mh">0x290</span> <span class="p">:</span> <span class="n">EnvironmentSize</span>                <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x294</span> <span class="p">:</span> <span class="n">EnvironmentVersion</span>             <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              6/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-7">
          <div class="inner">
            
            <header><h1>DLL Loading</h1></header>
            
            
            <section><p>_PEB._LDR_DATA</p>
<p>Contains 3 circular linked lists of loaded modules</p>
<ul>
<li>
<p>InLoadOrder</p>
<ul>
<li>Loaded into process. *.exe is always first.</li>
</ul>
</li>
<li>
<p>InMemoryOrder</p>
<ul>
<li>Order in which DLLs appear in memory. ASLR changes.</li>
</ul>
</li>
<li>
<p>InInitializationOrder</p>
<ul>
<li>When the DllMain fires.</li>
<li>Just because DLL is loaded does not mean it executes.</li>
</ul>
</li>
</ul>
<p>Malware/packers LOVES this</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              7/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-8">
          <div class="inner">
            
            <header><h1>PEB_LDR_DATA</h1></header>
            
            
            <section><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">dt</span><span class="p">(</span><span class="s">&quot;_PEB_LDR_DATA&quot;</span><span class="p">)</span>
 <span class="s">&#39;_PEB_LDR_DATA&#39;</span> <span class="p">(</span><span class="mi">48</span> <span class="nb">bytes</span><span class="p">)</span>
<span class="mh">0x0</span>   <span class="p">:</span> <span class="n">Length</span>                         <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x4</span>   <span class="p">:</span> <span class="n">Initialized</span>                    <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x8</span>   <span class="p">:</span> <span class="n">SsHandle</span>                       <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0xc</span>   <span class="p">:</span> <span class="n">InLoadOrderModuleList</span>          <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x14</span>  <span class="p">:</span> <span class="n">InMemoryOrderModuleList</span>        <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x1c</span>  <span class="p">:</span> <span class="n">InInitializationOrderModuleList</span> <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x24</span>  <span class="p">:</span> <span class="n">EntryInProgress</span>                <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ShutdownInProgress</span>             <span class="p">[</span><span class="s">&#39;unsigned char&#39;</span><span class="p">]</span>
<span class="mh">0x2c</span>  <span class="p">:</span> <span class="n">ShutdownThreadId</span>               <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              8/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-9">
          <div class="inner">
            
            <header><h1>DATA_TABLE_ENTRY</h1></header>
            
            
            <section><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">dt</span><span class="p">(</span><span class="s">&quot;_LDR_DATA_TABLE_ENTRY&quot;</span><span class="p">)</span>
<span class="s">&#39;_LDR_DATA_TABLE_ENTRY&#39;</span> <span class="p">(</span><span class="mi">120</span> <span class="nb">bytes</span><span class="p">)</span>
<span class="mh">0x0</span>   <span class="p">:</span> <span class="n">InLoadOrderLinks</span>               <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x8</span>   <span class="p">:</span> <span class="n">InMemoryOrderLinks</span>             <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x10</span>  <span class="p">:</span> <span class="n">InInitializationOrderLinks</span>     <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x18</span>  <span class="p">:</span> <span class="n">DllBase</span>                        <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x1c</span>  <span class="p">:</span> <span class="n">EntryPoint</span>                     <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x20</span>  <span class="p">:</span> <span class="n">SizeOfImage</span>                    <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x24</span>  <span class="p">:</span> <span class="n">FullDllName</span>                    <span class="p">[</span><span class="s">&#39;_UNICODE_STRING&#39;</span><span class="p">]</span>
<span class="mh">0x2c</span>  <span class="p">:</span> <span class="n">BaseDllName</span>                    <span class="p">[</span><span class="s">&#39;_UNICODE_STRING&#39;</span><span class="p">]</span>
<span class="mh">0x34</span>  <span class="p">:</span> <span class="n">Flags</span>                          <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x38</span>  <span class="p">:</span> <span class="n">LoadCount</span>                      <span class="p">[</span><span class="s">&#39;unsigned short&#39;</span><span class="p">]</span>
<span class="mh">0x3a</span>  <span class="p">:</span> <span class="n">TlsIndex</span>                       <span class="p">[</span><span class="s">&#39;unsigned short&#39;</span><span class="p">]</span>
<span class="mh">0x3c</span>  <span class="p">:</span> <span class="n">HashLinks</span>                      <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x3c</span>  <span class="p">:</span> <span class="n">SectionPointer</span>                 <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x40</span>  <span class="p">:</span> <span class="n">CheckSum</span>                       <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x44</span>  <span class="p">:</span> <span class="n">LoadedImports</span>                  <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x44</span>  <span class="p">:</span> <span class="n">TimeDateStamp</span>                  <span class="p">[</span><span class="s">&#39;UnixTimeStamp&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;is_utc&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}]</span>
<span class="mh">0x48</span>  <span class="p">:</span> <span class="n">EntryPointActivationContext</span>    <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;_ACTIVATION_CONTEXT&#39;</span><span class="p">]]</span>
<span class="mh">0x4c</span>  <span class="p">:</span> <span class="n">PatchInformation</span>               <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x50</span>  <span class="p">:</span> <span class="n">ForwarderLinks</span>                 <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x58</span>  <span class="p">:</span> <span class="n">ServiceTagLinks</span>                <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x60</span>  <span class="p">:</span> <span class="n">StaticLinks</span>                    <span class="p">[</span><span class="s">&#39;_LIST_ENTRY&#39;</span><span class="p">]</span>
<span class="mh">0x68</span>  <span class="p">:</span> <span class="n">ContextInformation</span>             <span class="p">[</span><span class="s">&#39;pointer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;void&#39;</span><span class="p">]]</span>
<span class="mh">0x6c</span>  <span class="p">:</span> <span class="n">OriginalBase</span>                   <span class="p">[</span><span class="s">&#39;unsigned long&#39;</span><span class="p">]</span>
<span class="mh">0x70</span>  <span class="p">:</span> <span class="n">LoadTime</span>                       <span class="p">[</span><span class="s">&#39;WinTimeStamp&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;is_utc&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}]</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              9/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-10">
          <div class="inner">
            
            <header><h1>_PEB Enumeration</h1></header>
            
            
            <section><p>Windbg</p>
<ul>
<li>!PEB</li>
<li>Requires debugging symbols<ul>
<li>Pain to get.. <a href="https://support.microsoft.com/en-us/kb/311503" title="here">https://support.microsoft.com/en-us/kb/311503</a></li>
</ul>
</li>
</ul>
<p>Volatility</p>
<ul>
<li>Find address of _EPROCESS</li>
<li>Go to _PEB</li>
<li>List strucutre</li>
</ul>
<p>PEB <em>could</em> be paged </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              10/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-11">
          <div class="inner">
            
            <header><h1>Enumeration</h1></header>
            
            
            <section><div class="highlight"><pre>0:003&gt; !peb
PEB at 000007fffffdf000
    InheritedAddressSpace:    No
    ReadImageFileExecOptions: No
    BeingDebugged:            Yes
    ImageBaseAddress:         00000000ff510000
    Ldr                       0000000077482640
    Ldr.Initialized:          Yes
    Ldr.InInitializationOrderModuleList: 00000000000e3030 . 0000000000152740
    Ldr.InLoadOrderModuleList:           00000000000e2f20 . 0000000000152720
    Ldr.InMemoryOrderModuleList:         00000000000e2f30 . 0000000000152730
            Base TimeStamp                     Module
        ff510000 4a5bc9d4 Jul <span class="m">13</span> 16:57:08 <span class="m">2009</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\c</span>alc.exe
        <span class="m">77350000</span> 521eaf24 Aug <span class="m">28</span> 19:17:08 <span class="m">2013</span> C:<span class="se">\W</span>indows<span class="se">\S</span>YSTEM32<span class="se">\n</span>tdll.dll
        <span class="m">77130000</span> 5315a059 Mar <span class="m">04</span> 01:43:53 <span class="m">2014</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\k</span>ernel32.dll
     7fefd430000 5315a05a Mar <span class="m">04</span> 01:43:54 <span class="m">2014</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\K</span>ERNELBASE.dll
     7fefe090000 54dd89c7 Feb <span class="m">12</span> 21:21:11 <span class="m">2015</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\S</span>HELL32.dll
     7feff5b0000 4eeb033f Dec <span class="m">16</span> 00:37:19 <span class="m">2011</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\m</span>svcrt.dll
     7feff530000 4ce7c9ab Nov <span class="m">20</span> 05:14:19 <span class="m">2010</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\S</span>HLWAPI.dll
     7feff4c0000 53f7f650 Aug <span class="m">22</span> 19:02:56 <span class="m">2014</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\G</span>DI32.dll
        <span class="m">77250000</span> 4ce7c9f1 Nov <span class="m">20</span> 05:15:29 <span class="m">2010</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\U</span>SER32.dll
     7feff650000 54e6ba7d Feb <span class="m">19</span> 20:39:25 <span class="m">2015</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\L</span>PK.dll
     7feff3f0000 5359c98c Apr <span class="m">24</span> 19:33:48 <span class="m">2014</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\U</span>SP10.dll
     7fefb650000 535b1ac9 Apr <span class="m">25</span> 19:32:41 <span class="m">2014</span> C:<span class="se">\W</span>indows<span class="se">\W</span>inSxS<span class="se">\a</span>md64_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.7601.18455_none_2b283fd671e9bf4d<span class="se">\g</span>diplus.dll
     7feff1e0000 4ce7c92c Nov <span class="m">20</span> 05:12:12 <span class="m">2010</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\o</span>le32.dll
     7fefdc70000 53c339ee Jul <span class="m">13</span> 19:01:18 <span class="m">2014</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\R</span>PCRT4.dll
     7feff020000 521eae52 Aug <span class="m">28</span> 19:13:38 <span class="m">2013</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\A</span>DVAPI32.dll
     7fefee70000 4a5be05e Jul <span class="m">13</span> 18:33:18 <span class="m">2009</span> C:<span class="se">\W</span>indows<span class="se">\S</span>YSTEM32<span class="se">\s</span>echost.dll
     7feff100000 5441ca8a Oct <span class="m">17</span> 19:03:54 <span class="m">2014</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\O</span>LEAUT32.dll
     7fefb870000 4a5be093 Jul <span class="m">13</span> 18:34:11 <span class="m">2009</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\U</span>xTheme.dll
     7fefba80000 4ce7c45b Nov <span class="m">20</span> 04:51:39 <span class="m">2010</span> C:<span class="se">\W</span>indows<span class="se">\W</span>inSxS<span class="se">\a</span>md64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.17514_none_fa396087175ac9ac<span class="se">\C</span>OMCTL32.dll
     7fefac60000 4a5be0b0 Jul <span class="m">13</span> 18:34:40 <span class="m">2009</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\W</span>INMM.dll
     7fefbf70000 4a5be082 Jul <span class="m">13</span> 18:33:54 <span class="m">2009</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\V</span>ERSION.dll
     7fefd4d0000 4a5bdf40 Jul <span class="m">13</span> 18:28:32 <span class="m">2009</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\I</span>MM32.DLL
     7fefee90000 54b9cd47 Jan <span class="m">16</span> 18:47:35 <span class="m">2015</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\M</span>SCTF.dll
     7fefa910000 54c9c3ff Jan <span class="m">28</span> 21:24:15 <span class="m">2015</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\W</span>indowsCodecs.dll
     7fefb020000 4a5bdf27 Jul <span class="m">13</span> 18:28:07 <span class="m">2009</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\d</span>wmapi.dll
     7fefcfb0000 4a5bdf91 Jul <span class="m">13</span> 18:29:53 <span class="m">2009</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\C</span>RYPTBASE.dll
     7fefddc0000 4a5bdeba Jul <span class="m">13</span> 18:26:18 <span class="m">2009</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\C</span>LBCatQ.DLL
     7fefa030000 4e587ee5 Aug <span class="m">26</span> 22:21:41 <span class="m">2011</span> C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\o</span>leacc.dll
    SubSystemData:     0000000000000000
    ProcessHeap:       00000000000e0000
    ProcessParameters: 00000000000e22b0
    CurrentDirectory:  <span class="s1">&#39;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Accessories\&#39;</span>
    WindowTitle:  <span class="s1">&#39;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Accessories\Calculator.lnk&#39;</span>
    ImageFile:    <span class="s1">&#39;C:\Windows\system32\calc.exe&#39;</span>
    CommandLine:  <span class="s1">&#39;&quot;C:\Windows\system32\calc.exe&quot; &#39;</span>
    DllPath:      <span class="s1">&#39;C:\Windows\system32;;C:\Windows\system32;C:\Windows\system;C:\Windows;.;C:\Python27\;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;c:\/bin;C:\Program Files\TortoiseGit\bin;C:\Program Files (x86)\Windows Kits\8.1\Windows Performance Toolkit\;C:\Program Files\Microsoft SQL Server\110\Tools\Binn\;C:\HashiCorp\Vagrant\bin;C:\Program Files (x86)\OpenSSH\bin;C:\Users\Topher\AppData\Local\Pandoc\;C:\Program Files (x86)\Microsoft Visual Studio 12.0\V;C\bin;C:\Python27\Scripts;C:\MinGW\bin;C:\Program Files (x86)\Prince\Engine\bin;&#39;</span>
    Environment:  <span class="nv">00000000000e1320</span>
        <span class="o">=</span>::<span class="o">=</span>::<span class="se">\</span>
        <span class="nv">ALLUSERSPROFILE</span><span class="o">=</span>C:<span class="se">\P</span>rogramData
        <span class="nv">APPDATA</span><span class="o">=</span>C:<span class="se">\U</span>sers<span class="se">\T</span>opher<span class="se">\A</span>ppData<span class="se">\R</span>oaming
        <span class="nv">CommonProgramFiles</span><span class="o">=</span>C:<span class="se">\P</span>rogram Files<span class="se">\C</span>ommon Files
        CommonProgramFiles<span class="o">(</span>x86<span class="o">)=</span>C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span><span class="se">\C</span>ommon Files
        <span class="nv">CommonProgramW6432</span><span class="o">=</span>C:<span class="se">\P</span>rogram Files<span class="se">\C</span>ommon Files
        <span class="nv">COMPUTERNAME</span><span class="o">=</span>TOPHER-PC
        <span class="nv">ComSpec</span><span class="o">=</span>C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\c</span>md.exe
        <span class="nv">CYGWIN</span><span class="o">=</span>tty
        <span class="nv">FP_NO_HOST_CHECK</span><span class="o">=</span>NO
        <span class="nv">GIT_SSH</span><span class="o">=</span>C:<span class="se">\P</span>rogram Files<span class="se">\T</span>ortoiseGit<span class="se">\b</span>in<span class="se">\T</span>ortoiseGitPlink.exe
        <span class="nv">HOMEDRIVE</span><span class="o">=</span>C:
        <span class="nv">HOMEPATH</span><span class="o">=</span><span class="se">\U</span>sers<span class="se">\T</span>opher
        <span class="nv">LOCALAPPDATA</span><span class="o">=</span>C:<span class="se">\U</span>sers<span class="se">\T</span>opher<span class="se">\A</span>ppData<span class="se">\L</span>ocal
        <span class="nv">LOGONSERVER</span><span class="o">=</span><span class="se">\\</span>TOPHER-PC
        <span class="nv">NUMBER_OF_PROCESSORS</span><span class="o">=</span>8
        <span class="nv">OS</span><span class="o">=</span>Windows_NT
        <span class="nv">Path</span><span class="o">=</span>C:<span class="se">\P</span>ython27<span class="se">\;</span>C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="p">;</span>C:<span class="se">\W</span>indows<span class="p">;</span>C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\W</span>bem<span class="p">;</span>C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\W</span>indowsPowerShell<span class="se">\v</span>1.0<span class="se">\;</span>c:<span class="se">\/</span>bin<span class="p">;</span>C:<span class="se">\P</span>rogram Files<span class="se">\T</span>ortoiseGit<span class="se">\b</span>in<span class="p">;</span>C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span><span class="se">\W</span>indows Kits<span class="se">\8</span>.1<span class="se">\W</span>indows Performance Toolkit<span class="se">\;</span>C:<span class="se">\P</span>rogram Files<span class="se">\M</span>icrosoft SQL Server<span class="se">\1</span>10<span class="se">\T</span>ools<span class="se">\B</span>inn<span class="se">\;</span>C:<span class="se">\H</span>ashiCorp<span class="se">\V</span>agrant<span class="se">\b</span>in<span class="p">;</span>C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span><span class="se">\O</span>penSSH<span class="se">\b</span>in<span class="p">;</span>C:<span class="se">\U</span>sers<span class="se">\T</span>opher<span class="se">\A</span>ppData<span class="se">\L</span>ocal<span class="se">\P</span>andoc<span class="se">\;</span>C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span><span class="se">\M</span>icrosoft Visual Studio 12.0<span class="se">\V</span><span class="p">;</span>C<span class="se">\b</span>in<span class="p">;</span>C:<span class="se">\P</span>ython27<span class="se">\S</span>cripts<span class="p">;</span>C:<span class="se">\M</span>inGW<span class="se">\b</span>in<span class="p">;</span>C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span><span class="se">\P</span>rince<span class="se">\E</span>ngine<span class="se">\b</span>in<span class="p">;</span>
        <span class="nv">PATHEXT</span><span class="o">=</span>.COM<span class="p">;</span>.EXE<span class="p">;</span>.BAT<span class="p">;</span>.CMD<span class="p">;</span>.VBS<span class="p">;</span>.VBE<span class="p">;</span>.JS<span class="p">;</span>.JSE<span class="p">;</span>.WSF<span class="p">;</span>.WSH<span class="p">;</span>.MSC
        <span class="nv">PROCESSOR_ARCHITECTURE</span><span class="o">=</span>AMD64
        <span class="nv">PROCESSOR_IDENTIFIER</span><span class="o">=</span>Intel64 Family <span class="m">6</span> Model <span class="m">60</span> Stepping 3, GenuineIntel
        <span class="nv">PROCESSOR_LEVEL</span><span class="o">=</span>6
        <span class="nv">PROCESSOR_REVISION</span><span class="o">=</span>3c03
        <span class="nv">ProgramData</span><span class="o">=</span>C:<span class="se">\P</span>rogramData
        <span class="nv">ProgramFiles</span><span class="o">=</span>C:<span class="se">\P</span>rogram Files
        ProgramFiles<span class="o">(</span>x86<span class="o">)=</span>C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span>
        <span class="nv">ProgramW6432</span><span class="o">=</span>C:<span class="se">\P</span>rogram Files
        <span class="nv">PSModulePath</span><span class="o">=</span>C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\W</span>indowsPowerShell<span class="se">\v</span>1.0<span class="se">\M</span>odules<span class="se">\</span>
        <span class="nv">PUBLIC</span><span class="o">=</span>C:<span class="se">\U</span>sers<span class="se">\P</span>ublic
        <span class="nv">SESSIONNAME</span><span class="o">=</span>Console
        <span class="nv">SVN_SSH</span><span class="o">=</span>C:<span class="se">\P</span>rogram Files<span class="se">\T</span>ortoiseGit<span class="se">\b</span>in<span class="se">\T</span>ortoiseGitPlink.exe
        <span class="nv">SystemDrive</span><span class="o">=</span>C:
        <span class="nv">SystemRoot</span><span class="o">=</span>C:<span class="se">\W</span>indows
        <span class="nv">TEMP</span><span class="o">=</span>C:<span class="se">\U</span>sers<span class="se">\T</span>opher<span class="se">\A</span>ppData<span class="se">\L</span>ocal<span class="se">\T</span>emp
        <span class="nv">TMP</span><span class="o">=</span>C:<span class="se">\U</span>sers<span class="se">\T</span>opher<span class="se">\A</span>ppData<span class="se">\L</span>ocal<span class="se">\T</span>emp
        <span class="nv">USERDOMAIN</span><span class="o">=</span>Topher-PC
        <span class="nv">USERNAME</span><span class="o">=</span>Topher
        <span class="nv">USERPROFILE</span><span class="o">=</span>C:<span class="se">\U</span>sers<span class="se">\T</span>opher
        <span class="nv">VBOX_MSI_INSTALL_PATH</span><span class="o">=</span>C:<span class="se">\P</span>rogram Files<span class="se">\O</span>racle<span class="se">\V</span>irtualBox<span class="se">\</span>
        <span class="nv">VS120COMNTOOLS</span><span class="o">=</span>C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span><span class="se">\M</span>icrosoft Visual Studio 12.0<span class="se">\C</span>ommon7<span class="se">\T</span>ools<span class="se">\</span>
        <span class="nv">windir</span><span class="o">=</span>C:<span class="se">\W</span>indows
        <span class="nv">windows_tracing_flags</span><span class="o">=</span>3
        <span class="nv">windows_tracing_logfile</span><span class="o">=</span>C:<span class="se">\B</span>VTBin<span class="se">\T</span>ests<span class="se">\i</span>nstallpackage<span class="se">\c</span>silogfile.log
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
              <p>Dll paths,
Full environment variables
All DLLS loaded</p>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              11/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-12">
          <div class="inner">
            
            <header><h1>With Volatility</h1></header>
            
            
            <section><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">sc</span><span class="p">()</span>
<span class="n">Current</span> <span class="n">context</span><span class="p">:</span> <span class="n">explorer</span><span class="o">.</span><span class="n">exe</span> <span class="err">@</span> <span class="mh">0x8625b420</span><span class="p">,</span> <span class="n">pid</span><span class="o">=</span><span class="mi">352</span><span class="p">,</span> <span class="n">ppid</span><span class="o">=</span><span class="mi">1848</span> <span class="n">DTB</span><span class="o">=</span><span class="mh">0x3ecec3e0</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">dt</span><span class="p">(</span><span class="s">&quot;_EPROCESS&quot;</span><span class="p">,</span> <span class="mh">0x8625b420</span><span class="p">)</span>
<span class="p">[</span><span class="n">_EPROCESS</span> <span class="n">_EPROCESS</span><span class="p">]</span> <span class="err">@</span> <span class="mh">0x8625B420</span>
<span class="mh">0x1a8</span> <span class="p">:</span> <span class="n">Peb</span>                            <span class="mi">2147332096</span>


<span class="o">&gt;&gt;&gt;</span> <span class="n">dt</span><span class="p">(</span><span class="s">&quot;_PEB&quot;</span><span class="p">,</span> <span class="mi">2147332096</span><span class="p">)</span>
<span class="p">[</span><span class="n">CType</span> <span class="n">_PEB</span><span class="p">]</span> <span class="err">@</span> <span class="mh">0x7FFDB000</span>
<span class="mh">0x0</span>   <span class="p">:</span> <span class="n">InheritedAddressSpace</span>          <span class="mi">0</span>
<span class="mh">0x1</span>   <span class="p">:</span> <span class="n">ReadImageFileExecOptions</span>       <span class="mi">0</span>
<span class="mh">0x2</span>   <span class="p">:</span> <span class="n">BeingDebugged</span>                  <span class="mi">0</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">BitField</span>                       <span class="mi">8</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">ImageUsesLargePages</span>            <span class="mi">0</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">IsImageDynamicallyRelocated</span>    <span class="mi">1</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">IsLegacyProcess</span>                <span class="mi">0</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">IsProtectedProcess</span>             <span class="mi">0</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">SkipPatchingUser32Forwarders</span>   <span class="mi">0</span>
<span class="mh">0x3</span>   <span class="p">:</span> <span class="n">SpareBits</span>                      <span class="mi">0</span>
<span class="mh">0x4</span>   <span class="p">:</span> <span class="n">Mutant</span>                         <span class="mi">4294967295</span>
<span class="mh">0x8</span>   <span class="p">:</span> <span class="n">ImageBaseAddress</span>               <span class="mi">10027008</span>
<span class="mh">0xc</span>   <span class="p">:</span> <span class="n">Ldr</span>                            <span class="mi">2003400832</span>
<span class="mh">0x10</span>  <span class="p">:</span> <span class="n">ProcessParameters</span>              <span class="mi">1774304</span>
<span class="mh">0x14</span>  <span class="p">:</span> <span class="n">SubSystemData</span>                  <span class="mi">0</span>
<span class="mh">0x18</span>  <span class="p">:</span> <span class="n">ProcessHeap</span>                    <span class="mi">1769472</span>
<span class="mh">0x1c</span>  <span class="p">:</span> <span class="n">FastPebLock</span>                    <span class="mi">2003399552</span>
<span class="mh">0x20</span>  <span class="p">:</span> <span class="n">AtlThunkSListPtr</span>               <span class="mi">0</span>
<span class="mh">0x24</span>  <span class="p">:</span> <span class="n">IFEOKey</span>                        <span class="mi">0</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">CrossProcessFlags</span>              <span class="mi">0</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ProcessInJob</span>                   <span class="mi">0</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ProcessInitializing</span>            <span class="mi">0</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ProcessUsingFTH</span>                <span class="mi">0</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ProcessUsingVCH</span>                <span class="mi">0</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ProcessUsingVEH</span>                <span class="mi">0</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ReservedBits0</span>                  <span class="mi">0</span>
<span class="mh">0x2c</span>  <span class="p">:</span> <span class="n">KernelCallbackTable</span>            <span class="mi">1996871016</span>
<span class="mh">0x2c</span>  <span class="p">:</span> <span class="n">UserSharedInfoPtr</span>              <span class="mi">1996871016</span>
<span class="mh">0x30</span>  <span class="p">:</span> <span class="n">SystemReserved</span>                 <span class="o">-</span>
<span class="mh">0x34</span>  <span class="p">:</span> <span class="n">AtlThunkSListPtr32</span>             <span class="mi">66783744</span>
<span class="mh">0x38</span>  <span class="p">:</span> <span class="n">ApiSetMap</span>                      <span class="mi">2004877312</span>
<span class="mh">0x3c</span>  <span class="p">:</span> <span class="n">TlsExpansionCounter</span>            <span class="mi">0</span>
<span class="mh">0x40</span>  <span class="p">:</span> <span class="n">TlsBitmap</span>                      <span class="mi">2003399264</span>
<span class="mh">0x44</span>  <span class="p">:</span> <span class="n">TlsBitmapBits</span>                  <span class="o">-</span>
<span class="mh">0x4c</span>  <span class="p">:</span> <span class="n">ReadOnlySharedMemoryBase</span>       <span class="mi">2137980928</span>
<span class="mh">0x50</span>  <span class="p">:</span> <span class="n">HotpatchInformation</span>            <span class="mi">0</span>
<span class="mh">0x54</span>  <span class="p">:</span> <span class="n">ReadOnlyStaticServerData</span>       <span class="mi">2137982352</span>
<span class="mh">0x58</span>  <span class="p">:</span> <span class="n">AnsiCodePageData</span>               <span class="mi">2147155968</span>
<span class="mh">0x5c</span>  <span class="p">:</span> <span class="n">OemCodePageData</span>                <span class="mi">2147222052</span>
<span class="mh">0x60</span>  <span class="p">:</span> <span class="n">UnicodeCaseTableData</span>           <span class="mi">2147288648</span>
<span class="mh">0x64</span>  <span class="p">:</span> <span class="n">NumberOfProcessors</span>             <span class="mi">1</span>
<span class="mh">0x68</span>  <span class="p">:</span> <span class="n">NtGlobalFlag</span>                   <span class="mi">0</span>
<span class="mh">0x70</span>  <span class="p">:</span> <span class="n">CriticalSectionTimeout</span>         <span class="mi">2147332208</span>
<span class="mh">0x78</span>  <span class="p">:</span> <span class="n">HeapSegmentReserve</span>             <span class="mi">1048576</span>
<span class="mh">0x7c</span>  <span class="p">:</span> <span class="n">HeapSegmentCommit</span>              <span class="mi">8192</span>
<span class="mh">0x80</span>  <span class="p">:</span> <span class="n">HeapDeCommitTotalFreeThreshold</span> <span class="mi">65536</span>
<span class="mh">0x84</span>  <span class="p">:</span> <span class="n">HeapDeCommitFreeBlockThreshold</span> <span class="mi">4096</span>
<span class="mh">0x88</span>  <span class="p">:</span> <span class="n">NumberOfHeaps</span>                  <span class="mi">13</span>
<span class="mh">0x8c</span>  <span class="p">:</span> <span class="n">MaximumNumberOfHeaps</span>           <span class="mi">16</span>
<span class="mh">0x90</span>  <span class="p">:</span> <span class="n">ProcessHeaps</span>                   <span class="mi">2003399936</span>
<span class="mh">0x94</span>  <span class="p">:</span> <span class="n">GdiSharedHandleTable</span>           <span class="mi">3997696</span>
<span class="mh">0x98</span>  <span class="p">:</span> <span class="n">ProcessStarterHelper</span>           <span class="mi">0</span>
<span class="mh">0x9c</span>  <span class="p">:</span> <span class="n">GdiDCAttributeList</span>             <span class="mi">20</span>
<span class="mh">0xa0</span>  <span class="p">:</span> <span class="n">LoaderLock</span>                     <span class="mi">2003399488</span>
<span class="mh">0xa4</span>  <span class="p">:</span> <span class="n">OSMajorVersion</span>                 <span class="mi">6</span>
<span class="mh">0xa8</span>  <span class="p">:</span> <span class="n">OSMinorVersion</span>                 <span class="mi">1</span>
<span class="mh">0xac</span>  <span class="p">:</span> <span class="n">OSBuildNumber</span>                  <span class="mi">7601</span>
<span class="mh">0xae</span>  <span class="p">:</span> <span class="n">OSCSDVersion</span>                   <span class="mi">256</span>
<span class="mh">0xb0</span>  <span class="p">:</span> <span class="n">OSPlatformId</span>                   <span class="mi">2</span>
<span class="mh">0xb4</span>  <span class="p">:</span> <span class="n">ImageSubsystem</span>                 <span class="mi">2</span>
<span class="mh">0xb8</span>  <span class="p">:</span> <span class="n">ImageSubsystemMajorVersion</span>     <span class="mi">6</span>
<span class="mh">0xbc</span>  <span class="p">:</span> <span class="n">ImageSubsystemMinorVersion</span>     <span class="mi">1</span>
<span class="mh">0xc0</span>  <span class="p">:</span> <span class="n">ActiveProcessAffinityMask</span>      <span class="mi">1</span>
<span class="mh">0xc4</span>  <span class="p">:</span> <span class="n">GdiHandleBuffer</span>                <span class="o">-</span>
<span class="mh">0x14c</span> <span class="p">:</span> <span class="n">PostProcessInitRoutine</span>         <span class="mi">0</span>
<span class="mh">0x150</span> <span class="p">:</span> <span class="n">TlsExpansionBitmap</span>             <span class="mi">2003399272</span>
<span class="mh">0x154</span> <span class="p">:</span> <span class="n">TlsExpansionBitmapBits</span>         <span class="o">-</span>
<span class="mh">0x1d4</span> <span class="p">:</span> <span class="n">SessionId</span>                      <span class="mi">1</span>
<span class="mh">0x1d8</span> <span class="p">:</span> <span class="n">AppCompatFlags</span>                 <span class="mi">2147332568</span>
<span class="mh">0x1e0</span> <span class="p">:</span> <span class="n">AppCompatFlagsUser</span>             <span class="mi">2147332576</span>
<span class="mh">0x1e8</span> <span class="p">:</span> <span class="n">pShimData</span>                      <span class="mi">0</span>
<span class="mh">0x1ec</span> <span class="p">:</span> <span class="n">AppCompatInfo</span>                  <span class="mi">0</span>
<span class="mh">0x1f0</span> <span class="p">:</span> <span class="n">CSDVersion</span>                     <span class="n">Service</span> <span class="n">Pack</span> <span class="mi">1</span>
<span class="mh">0x1f8</span> <span class="p">:</span> <span class="n">ActivationContextData</span>          <span class="mi">262144</span>
<span class="mh">0x1fc</span> <span class="p">:</span> <span class="n">ProcessAssemblyStorageMap</span>      <span class="mi">1945264</span>
<span class="mh">0x200</span> <span class="p">:</span> <span class="n">SystemDefaultActivationContextData</span> <span class="mi">196608</span>
<span class="mh">0x204</span> <span class="p">:</span> <span class="n">SystemAssemblyStorageMap</span>       <span class="mi">1839920</span>
<span class="mh">0x208</span> <span class="p">:</span> <span class="n">MinimumStackCommit</span>             <span class="mi">0</span>
<span class="mh">0x20c</span> <span class="p">:</span> <span class="n">FlsCallback</span>                    <span class="mi">1846536</span>
<span class="mh">0x210</span> <span class="p">:</span> <span class="n">FlsListHead</span>                    <span class="mi">2147332624</span>
<span class="mh">0x218</span> <span class="p">:</span> <span class="n">FlsBitmap</span>                      <span class="mi">2003399280</span>
<span class="mh">0x21c</span> <span class="p">:</span> <span class="n">FlsBitmapBits</span>                  <span class="o">-</span>
<span class="mh">0x22c</span> <span class="p">:</span> <span class="n">FlsHighIndex</span>                   <span class="mi">3</span>
<span class="mh">0x230</span> <span class="p">:</span> <span class="n">WerRegistrationData</span>            <span class="mi">55640064</span>
<span class="mh">0x234</span> <span class="p">:</span> <span class="n">WerShipAssertPtr</span>               <span class="mi">0</span>
<span class="mh">0x238</span> <span class="p">:</span> <span class="n">pContextData</span>                   <span class="mi">327680</span>
<span class="mh">0x23c</span> <span class="p">:</span> <span class="n">pImageHeaderHash</span>               <span class="mi">0</span>
<span class="mh">0x240</span> <span class="p">:</span> <span class="n">CritSecTracingEnabled</span>          <span class="mi">0</span>
<span class="mh">0x240</span> <span class="p">:</span> <span class="n">HeapTracingEnabled</span>             <span class="mi">0</span>
<span class="mh">0x240</span> <span class="p">:</span> <span class="n">SpareTracingBits</span>               <span class="mi">0</span>
<span class="mh">0x240</span> <span class="p">:</span> <span class="n">TracingFlags</span>                   <span class="mi">0</span>


<span class="o">&gt;&gt;&gt;</span> <span class="n">dt</span><span class="p">(</span><span class="s">&quot;_PEB_LDR_DATA&quot;</span><span class="p">,</span> <span class="mi">2003400832</span><span class="p">)</span>
<span class="p">[</span><span class="n">CType</span> <span class="n">_PEB_LDR_DATA</span><span class="p">]</span> <span class="err">@</span> <span class="mh">0x77697880</span>
<span class="mh">0x0</span>   <span class="p">:</span> <span class="n">Length</span>                         <span class="mi">48</span>
<span class="mh">0x4</span>   <span class="p">:</span> <span class="n">Initialized</span>                    <span class="mi">1</span>
<span class="mh">0x8</span>   <span class="p">:</span> <span class="n">SsHandle</span>                       <span class="mi">0</span>
<span class="mh">0xc</span>   <span class="p">:</span> <span class="n">InLoadOrderModuleList</span>          <span class="mi">2003400844</span>
<span class="mh">0x14</span>  <span class="p">:</span> <span class="n">InMemoryOrderModuleList</span>        <span class="mi">2003400852</span>
<span class="mh">0x1c</span>  <span class="p">:</span> <span class="n">InInitializationOrderModuleList</span> <span class="mi">2003400860</span>
<span class="mh">0x24</span>  <span class="p">:</span> <span class="n">EntryInProgress</span>                <span class="mi">0</span>
<span class="mh">0x28</span>  <span class="p">:</span> <span class="n">ShutdownInProgress</span>             <span class="mi">0</span>
<span class="mh">0x2c</span>  <span class="p">:</span> <span class="n">ShutdownThreadId</span>               <span class="mi">0</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              12/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-13">
          <div class="inner">
            
            <header><h1>Environment Variables</h1></header>
            
            
            <section><p>_PEB.ProcessParameters.Envvionrment</p>
<h2>- Points to NULL-terminated strings</h2>
<p>Attackers use to store shellcode/keys/flags. . .</p>
<p>Can set variables per user and process</p>
<p>Can be volatile and destroyed at system shutdown</p>
<div class="highlight"><pre>BOOL WINAPI SetEnvironmentVariable<span class="o">(</span>
  _In_      LPCTSTR lpName,
  _In_opt_  LPCTSTR lpValue
<span class="o">)</span><span class="p">;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              13/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-14">
          <div class="inner">
            
            <header><h1>Environment Variables</h1></header>
            
            
            <section><p>Child processes inherit environment block</p>
<ul>
<li>Unless lpEnviornment is used in CreateProcess()</li>
</ul>
<p>Contains</p>
<ul>
<li>$PATH</li>
<li>$PATHEXT</li>
<li>$WINDIR</li>
<li>Temp Direcotires</li>
<li>User/Computer/Domain names</li>
<li>Location of cmd.exe</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              14/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-15">
          <div class="inner">
            
            <header><h1>ENV: Continued</h1></header>
            
            
            <section><p>$PATH and $PATHEXT</p>
<ul>
<li>Used to locate order in which to find files/executables</li>
<li>Path order hijacking</li>
<li>Start-&gt;Run-&gt;*.exe<ul>
<li>Could be alerted by PATH to look at user controlled location first</li>
</ul>
</li>
<li>Start-&gt;run-&gt;name</li>
<li>Looks for $PATHEXT for what to search for first if user does not specify .exe,.dll, etc. </li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              15/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-16">
          <div class="inner">
            
            <header><h1>ENV</h1></header>
            
            
            <section><p>Malware likes to not have duplicates of itself...</p>
<p>Remember Mutants?</p>
<p>Could also use ENV to check if a malware already is present on system</p>
<p>Add special argument to $PATH, $USERPROFILE, etc.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              16/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-17">
          <div class="inner">
            
            <header><h1>Process Heaps</h1></header>
            
            
            <section><p>Memdump and Vaddump contain heap artifacts</p>
<p>Yara also scans heaps</p>
<p>Heaps are for dynamic memory</p>
<p>Contain juicy sources of data</p>
<p>We have linked list of heaps now... go forth and scan!</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              17/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-18">
          <div class="inner">
            
            <header><h1>Standard Handles</h1></header>
            
            
            <section><p>Streams are special</p>
<ul>
<li>StdIn,StdOut,StdErr, Serial, etc.</li>
</ul>
<p>Windows calls these Standard Handles, but function like File Descriptors do in *unix land</p>
<p>Attackers want control of handles for backdoors</p>
<ul>
<li>Telnet, cmd, netcat, etc.</li>
</ul>
<p>Communications channels</p>
<ul>
<li>Stdin = 0x3</li>
<li>Stdout = 0x7</li>
<li>StdErr = 0xb</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              18/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-19">
          <div class="inner">
            
            <header><h1>Standard Handles</h1></header>
            
            
            <section><p>If a PID had weird handles for In,Out,Err</p>
<ul>
<li>Investigate further...</li>
<li>What is the device the handle is mapped to?</li>
<li>Is it a named pipe or network socket?</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              19/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-20">
          <div class="inner">
            
            <header><h1>Dynamic Link Libraries (DLLs)</h1></header>
            
            
            <section><p>Code and resources that can be shared between processes.</p>
<p>Run inside a host process... </p>
<ul>
<li>Access to all a process's resources!</li>
</ul>
<p>Loaded by</p>
<ul>
<li>Dependencies (DependancyWalker.exe)</li>
<li>Dyanmic Linking (Import Address Table, IAT, in PE)</li>
<li>Runtime linking (LoadLibrary. No IAT)</li>
<li>Code injection</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              20/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-21">
          <div class="inner">
            
            <header><h1>DLLs</h1></header>
            
            
            <section><p>Follow one of the three linked lists in the PEB for DLLs</p>
<p>Can unlink from the lists as PEB is in process space.</p>
<p>No need for kernel level module!</p>
<p>Still referenced in the VAD</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              21/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-22">
          <div class="inner">
            
            <header><h1>How DLL Unlinking Works</h1></header>
            
            
            <section><p><img alt="dllunlink" src="..\slideResources\peb\dllUnlink.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              22/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-23">
          <div class="inner">
            
            <header><h1>DllList</h1></header>
            
            
            <section><p>Volatility plugin to find DLLs</p>
<p>Walks the LoadOrder list</p>
<ul>
<li>Wants to not detect hidden DLLs</li>
</ul>
<p>If LoadCount is 0xffff (-1) then DLL loaded in IAT</p>
<p>If LoadCount != 0xffff, it was loaded by LoadLibrary</p>
<p>Not necessarily suspicious... </p>
<div class="highlight"><pre>  -o OFFSET, --offset<span class="o">=</span>OFFSET
                    EPROCESS offset <span class="o">(</span>in hex<span class="o">)</span> in the physical address space
  -p , --pid<span class="o">=</span>     Operate on these Process IDs <span class="o">(</span>comma-separated<span class="o">)</span>
  -n NAME, --name<span class="o">=</span>NAME  Operate on these process names <span class="o">(</span>regex<span class="o">)</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              23/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-24">
          <div class="inner">
            
            <header><h1>DllList</h1></header>
            
            
            <section><div class="highlight"><pre><span class="o">[</span>root<span class="p">&amp;</span>windows<span class="o">]</span><span class="c">#volatility -f Win7.bin --profile=Win7SP0x86 -p 352 dlllist</span>
Volatility Foundation Volatility Framework 2.4
************************************************************************
explorer.exe pid:    352
Command line : C:<span class="se">\W</span>indows<span class="se">\E</span>xplorer.EXE
Service Pack 1

Base             Size  LoadCount Path
---------- ---------- ---------- ----
0x00990000   0x281000     0xffff C:<span class="se">\W</span>indows<span class="se">\E</span>xplorer.EXE
0x775c0000   0x13c000     0xffff C:<span class="se">\W</span>indows<span class="se">\S</span>YSTEM32<span class="se">\n</span>tdll.dll
0x76dc0000    0xd4000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\k</span>ernel32.dll
0x75820000    0x4b000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\K</span>ERNELBASE.dll
0x77750000    0xa0000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\A</span>DVAPI32.dll
0x76f40000    0xac000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\m</span>svcrt.dll
0x77700000    0x19000     0xffff C:<span class="se">\W</span>indows<span class="se">\S</span>YSTEM32<span class="se">\s</span>echost.dll
0x75970000    0xa2000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\R</span>PCRT4.dll
0x75d10000    0x4e000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\G</span>DI32.dll
0x77040000    0xc9000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\U</span>SER32.dll
0x75960000     0xa000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\L</span>PK.dll
0x76ea0000    0x9d000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\U</span>SP10.dll
0x772b0000    0x57000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\S</span>HLWAPI.dll
0x760a0000   0xc4a000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\S</span>HELL32.dll
0x75bb0000   0x15c000     0xffff C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\o</span>le32.dll
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              24/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-25">
          <div class="inner">
            
            <header><h1>DLL Detection if Unlinked</h1></header>
            
            
            <section><p>PE File Scanning</p>
<ul>
<li>DLLs still have a PE header... </li>
<li>DLL Flag Present</li>
</ul>
<p>VAD</p>
<ul>
<li>VAD contains full paths to disk for files mapped</li>
<li>DLL could have been memory injected so no disk reference</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              25/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-26">
          <div class="inner">
            
            <header><h1>ldrmodules</h1></header>
            
            
            <section><p>Plugin to find DLLs that are hidden by going through all LDR lists and executable VAD nodes.  </p>
<p>Scans the VAD nodes first </p>
<p>Cross references with PEB LDR lists</p>
<div class="highlight"><pre>-o OFFSET, --offset<span class="o">=</span>OFFSET
                EPROCESS offset <span class="o">(</span>in hex<span class="o">)</span> in the physical address space
-p , --pid<span class="o">=</span>PID     Operate on these Process IDs <span class="o">(</span>comma-separated<span class="o">)</span>
-n NAME, --name<span class="o">=</span>NAME  Operate on these process names <span class="o">(</span>regex<span class="o">)</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              26/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-27">
          <div class="inner">
            
            <header><h1>ldrmodules</h1></header>
            
            
            <section><div class="highlight"><pre><span class="o">[</span>root<span class="p">&amp;</span>windows<span class="o">]</span><span class="c">#volatility -f Win7.bin --profile=Win7SP0x86 -p 352 ldrmodules</span>
Volatility Foundation Volatility Framework 2.4
Pid      Process              Base       InLoad InInit InMem MappedPath
-------- -------------------- ---------- ------ ------ ----- ----------
 <span class="m">352</span> explorer.exe         0x6f670000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\c</span>scui.dll
 <span class="m">352</span> explorer.exe         0x00990000 True   False  True  <span class="se">\W</span>indows<span class="se">\e</span>xplorer.exe
 <span class="m">352</span> explorer.exe         0x73d30000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\o</span>leacc.dll
 <span class="m">352</span> explorer.exe         0x73730000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\m</span>sacm32.drv
 <span class="m">352</span> explorer.exe         0x73f60000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\w</span>tsapi32.dll
 <span class="m">352</span> explorer.exe         0x637a0000 False  False  False <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\i</span>mageres.dll
 <span class="m">352</span> explorer.exe         0x6adb0000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\W</span>WanAPI.dll
 <span class="m">352</span> explorer.exe         0x709d0000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\P</span>ortableDeviceApi.dll
 <span class="m">352</span> explorer.exe         0x6afe0000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\Q</span>UTIL.DLL
 <span class="m">352</span> explorer.exe         0x075c0000 False  False  False <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\i</span>mageres.dll
 <span class="m">352</span> explorer.exe         0x71210000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\m</span>pr.dll
 <span class="m">352</span> explorer.exe         0x63380000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\a</span>cppage.dll
 <span class="m">352</span> explorer.exe         0x75820000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\K</span>ernelBase.dll
 <span class="m">352</span> explorer.exe         0x6ae30000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\w</span>wapi.dll
 <span class="m">352</span> explorer.exe         0x63440000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\S</span>tructuredQuery.dll
 <span class="m">352</span> explorer.exe         0x73a50000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\k</span>suser.dll
 <span class="m">352</span> explorer.exe         0x75670000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\m</span>sasn1.dll
 <span class="m">352</span> explorer.exe         0x74670000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\a</span>uthui.dll
 <span class="m">352</span> explorer.exe         0x6b290000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\n</span>etshell.dll
 <span class="m">352</span> explorer.exe         0x76ff0000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\W</span>ldap32.dll
 <span class="m">352</span> explorer.exe         0x754c0000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\s</span>ecur32.dll
 <span class="m">352</span> explorer.exe         0x73ad0000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\n</span>tmarta.dll
 <span class="m">352</span> explorer.exe         0x686a0000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\F</span>XSRESM.dll
 <span class="m">352</span> explorer.exe         0x740e0000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\d</span>wmapi.dll
 <span class="m">352</span> explorer.exe         0x6ad00000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\s</span>rchadmin.dll
 <span class="m">352</span> explorer.exe         0x77310000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\w</span>ininet.dll
 <span class="m">352</span> explorer.exe         0x75920000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\c</span>fgmgr32.dll
 <span class="m">352</span> explorer.exe         0x73f30000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\a</span>pi-ms-win-downlevel-shell32-l1-1-0.dll
 <span class="m">352</span> explorer.exe         0x73a60000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\w</span>dmaud.drv
 <span class="m">352</span> explorer.exe         0x6ad80000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\Q</span>AGENT.DLL
 <span class="m">352</span> explorer.exe         0x76cf0000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\m</span>sctf.dll
 <span class="m">352</span> explorer.exe         0x735c0000 True   True   True  <span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\I</span>PHLPAPI.DLL
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              27/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-28">
          <div class="inner">
            
            <header><h1>DLLDump</h1></header>
            
            
            <section><p>Plugin to dump a DLL to disk for analysis.</p>
<div class="highlight"><pre>-p PID
-D DUMP_DIR
-u unsafe to bypass checks
-r regex <span class="k">for</span> DLLs in memory
-o OFFSET
-b ImageAddressBase
</pre></div>

<p><br></p>
<div class="highlight"><pre><span class="p">[</span><span class="n">root</span><span class="o">&amp;</span><span class="n">windows</span><span class="p">]</span><span class="c">#volatility -f Win7.bin --profile=Win7SP0x86 -p 352 dlldump -D dumpedDlls/</span>
<span class="n">Volatility</span> <span class="n">Foundation</span> <span class="n">Volatility</span> <span class="n">Framework</span> <span class="mf">2.4</span>
<span class="n">Process</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="n">Name</span>                 <span class="n">Module</span> <span class="n">Base</span> <span class="n">Module</span> <span class="n">Name</span>          <span class="n">Result</span>
<span class="o">----------</span> <span class="o">--------------------</span> <span class="o">-----------</span> <span class="o">--------------------</span> <span class="o">------</span>
<span class="mh">0x8625b420</span> <span class="n">explorer</span><span class="o">.</span><span class="n">exe</span>         <span class="mh">0x000990000</span> <span class="n">Explorer</span><span class="o">.</span><span class="n">EXE</span>         <span class="n">OK</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="mf">352.3</span><span class="n">dc5b420</span><span class="o">.</span><span class="mf">990000.</span><span class="n">dll</span>
<span class="mh">0x8625b420</span> <span class="n">explorer</span><span class="o">.</span><span class="n">exe</span>         <span class="mh">0x0775c0000</span> <span class="n">ntdll</span><span class="o">.</span><span class="n">dll</span>            <span class="n">OK</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="mf">352.3</span><span class="n">dc5b420</span><span class="o">.</span><span class="mi">775</span><span class="n">c0000</span><span class="o">.</span><span class="n">dll</span>
<span class="mh">0x8625b420</span> <span class="n">explorer</span><span class="o">.</span><span class="n">exe</span>         <span class="mh">0x073d30000</span> <span class="n">OLEACC</span><span class="o">.</span><span class="n">dll</span>           <span class="n">OK</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="mf">352.3</span><span class="n">dc5b420</span><span class="o">.</span><span class="mi">73</span><span class="n">d30000</span><span class="o">.</span><span class="n">dll</span>
<span class="mh">0x8625b420</span> <span class="n">explorer</span><span class="o">.</span><span class="n">exe</span>         <span class="mh">0x0748b0000</span> <span class="n">SAMLIB</span><span class="o">.</span><span class="n">dll</span>           <span class="n">OK</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="mf">352.3</span><span class="n">dc5b420</span><span class="o">.</span><span class="mi">748</span><span class="n">b0000</span><span class="o">.</span><span class="n">dll</span>
<span class="mh">0x8625b420</span> <span class="n">explorer</span><span class="o">.</span><span class="n">exe</span>         <span class="mh">0x073f60000</span> <span class="n">WTSAPI32</span><span class="o">.</span><span class="n">dll</span>         <span class="n">OK</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="mf">352.3</span><span class="n">dc5b420</span><span class="o">.</span><span class="mi">73</span><span class="n">f60000</span><span class="o">.</span><span class="n">dll</span>
<span class="mh">0x8625b420</span> <span class="n">explorer</span><span class="o">.</span><span class="n">exe</span>         <span class="mh">0x0687a0000</span> <span class="n">FXSAPI</span><span class="o">.</span><span class="n">dll</span>           <span class="n">OK</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="mf">352.3</span><span class="n">dc5b420</span><span class="o">.</span><span class="mi">687</span><span class="n">a0000</span><span class="o">.</span><span class="n">dll</span>
<span class="mh">0x8625b420</span> <span class="n">explorer</span><span class="o">.</span><span class="n">exe</span>         <span class="mh">0x06adb0000</span> <span class="n">wwanapi</span><span class="o">.</span><span class="n">dll</span>          <span class="n">OK</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="mf">352.3</span><span class="n">dc5b420</span><span class="o">.</span><span class="mi">6</span><span class="n">adb0000</span><span class="o">.</span><span class="n">dll</span>
<span class="mh">0x8625b420</span> <span class="n">explorer</span><span class="o">.</span><span class="n">exe</span>         <span class="mh">0x070a60000</span> <span class="n">sfc_os</span><span class="o">.</span><span class="n">DLL</span>           <span class="n">OK</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="mf">352.3</span><span class="n">dc5b420</span><span class="o">.</span><span class="mi">70</span><span class="n">a60000</span><span class="o">.</span><span class="n">dll</span>
<span class="mh">0x8625b420</span> <span class="n">explorer</span><span class="o">.</span><span class="n">exe</span>         <span class="mh">0x0709d0000</span> <span class="n">PortableD</span><span class="o">...</span><span class="n">eApi</span><span class="o">.</span><span class="n">dll</span> <span class="n">OK</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="mf">352.3</span><span class="n">dc5b420</span><span class="o">.</span><span class="mi">709</span><span class="n">d0000</span><span class="o">.</span><span class="n">dll</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              28/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-29">
          <div class="inner">
            
            <header><h1>PE In Memory</h1></header>
            
            
            <section><p>PE executables also live in memory and can be carved</p>
<p>Remember DLLs, Exe and drivers follow PE struct</p>
<p>Not all PE sections are loaded in memory </p>
<p>Self-modifying code</p>
<p>Packed on disk → unpacked in memory</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              29/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-30">
          <div class="inner">
            
            <header><h1>In Memory</h1></header>
            
            
            <section><p>Can use Volshell to parse PE header for you</p>
<p>Get base address of process → EPROCESS → PEB → ImageBaseAddress </p>
<p>Can display structures inline with a memory address using volshell</p>
<p>dt(“_IMAGE_DOS_HEADER”, 0xADDRESS)</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              30/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-31">
          <div class="inner">
            
            <header><h1>Volatility</h1></header>
            
            
            <section><p>DllDump</p>
<ul>
<li>Carves DLL out of memory</li>
</ul>
<p>Procdump</p>
<ul>
<li>Carves an executable out of memory.</li>
</ul>
<p>Moddump</p>
<ul>
<li>Carves a kernel loaded module out of memory</li>
</ul>
<p>Can request slack space between sections in output file with –memory.</p>
<ul>
<li>Recall pages are on a 4,096KB boundary and PE sections might not be.  </li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              31/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-32">
          <div class="inner">
            
            <header><h1>Packing PE Files</h1></header>
            
            
            <section><p>Common method to obfuscate a PE to make analysis harder by preventing static analysis</p>
<p>Removes IAT </p>
<p>Compresses strings</p>
<p>Compresses sections into raw data</p>
<p>Could encrypt data</p>
<p>A new section is added to PE that has the unpacking stub</p>
<ul>
<li>UPX uses .UPX</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              32/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-33">
          <div class="inner">
            
            <header><h1>Other Notes</h1></header>
            
            
            <section><p>PE file can be stripped in memory as once loaded Windows no longer cares</p>
<p>Work has been done to have loader process heavily stripped PE header.</p>
<p>PE sections can be paged out of memory.</p>
<p>IAT needs to be reconstructed.</p>
<p>Not necessarily malicious...   </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              33/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-34">
          <div class="inner">
            
            <header><h1>Original Entry Point (OEP)</h1></header>
            
            
            <section><p>Normal PE files have entry point at the “main”. </p>
<p>Packed PE have entry point in the unpacking stub.</p>
<p>After PE goes through decryption routine the PE header is fixed up in memory and the stub jumps pack to the OEP to execute original binary.     </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              34/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-35">
          <div class="inner">
            
            
            <section><p><img alt="packer" src="..\slideResources\peb\packed.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              35/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-36">
          <div class="inner">
            
            <header><h1>Detecting Packed Binaries</h1></header>
            
            
            <section><p>Non-standard entry point</p>
<p>Weird section names</p>
<p>UPX and no .text/.code with any information in it</p>
<p>Writable and Executable memory sections</p>
<p>Size on disk &gt; size in memory</p>
<p>Few imports or Strings</p>
<p>Imports only GetProcAddress and LoadLibrary from Kernel32.</p>
<p>PeiD contains signatures of known packers</p>
<ul>
<li>YARA can use these</li>
<li>RDG Packer detects some packers better</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              36/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-37">
          <div class="inner">
            
            <header><h1>BUT</h1></header>
            
            
            <section><p>Packed binaries are only really a problem on disk</p>
<p>Can dump memory and binary is unpacked</p>
<ul>
<li>Some packers do not unpack the whole binary at load time. . .</li>
</ul>
<p>Find the section jump in debugger and dump executable after stub runs</p>
<ul>
<li>Typically called a tail jump</li>
<li>Anti-debugging/Anti-reversing is a hurdle.</li>
<li>Import Address Table is not reconstructed </li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              37/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-38">
          <div class="inner">
            
            <header><h1>Detecting packing on sizes</h1></header>
            
            
            <section><p>Size on disk &gt; virtual size in memory for sections</p>
<p><strong>unpacked</strong></p>
<div class="highlight"><pre>c:<span class="se">\b</span>in&gt;peparser.py -f ssdeep.exe -a
<span class="o">[</span>IMAGE_SECTION_HEADER<span class="o">]</span>
0x1A0      0x0   Name:                          .data
0x1A8      0x8   Misc:                          0x6334
0x1A8      0x8   Misc_PhysicalAddress:          0x6334
0x1A8      0x8   Misc_VirtualSize:              0x6334
0x1AC      0xC   VirtualAddress:                0x79000
0x1B0      0x10  SizeOfRawData:                 0x6400
0x1B4      0x14  PointerToRawData:              0x77E00
<span class="o">[</span>IMAGE_SECTION_HEADER<span class="o">]</span>
0x1C8      0x0   Name:                          .rdata
0x1D0      0x8   Misc:                          0xA208
0x1D0      0x8   Misc_PhysicalAddress:          0xA208
0x1D0      0x8   Misc_VirtualSize:              0xA208
0x1D4      0xC   VirtualAddress:                0x80000
0x1D8      0x10  SizeOfRawData:                 0xA400
0x1DC      0x14  PointerToRawData:              0x7E200
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              38/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-39">
          <div class="inner">
            
            <header><h1>Detecting packing on sizes</h1></header>
            
            
            <section><p><strong>Packed</strong></p>
<div class="highlight"><pre>c:<span class="se">\b</span>in&gt;upx.exe ssdeep.exe -o ssdeepPacked.exe   
        File size         Ratio      Format      Name
   --------------------   ------   -----------   -----------
    <span class="m">563712</span> -&gt;    <span class="m">165376</span>   29.34%    win32/pe     ssdeepPacked.exe   
Packed <span class="m">1</span> file.

c:<span class="se">\b</span>in&gt;peparser.py -f ssdeepPacked.exe -a
----------PE Sections----------
<span class="o">[</span>IMAGE_SECTION_HEADER<span class="o">]</span>
0x178      0x0   Name:                          UPX0
0x180      0x8   Misc:                          0x68000
0x180      0x8   Misc_PhysicalAddress:          0x68000
0x180      0x8   Misc_VirtualSize:              0x68000
0x184      0xC   VirtualAddress:                0x1000
0x188      0x10  SizeOfRawData:                 0x0
0x18C      0x14  PointerToRawData:              0x200

<span class="o">[</span>IMAGE_SECTION_HEADER<span class="o">]</span>
0x1A0      0x0   Name:                          UPX1
0x1A8      0x8   Misc:                          0x29000
0x1A8      0x8   Misc_PhysicalAddress:          0x29000
0x1A8      0x8   Misc_VirtualSize:              0x29000
0x1AC      0xC   VirtualAddress:                0x69000
0x1B0      0x10  SizeOfRawData:                 0x28200
0x1B4      0x14  PointerToRawData:              0x200


<span class="o">[</span>IMAGE_SECTION_HEADER<span class="o">]</span>
0x1C8      0x0   Name:                          UPX2
0x1D0      0x8   Misc:                          0x1000
0x1D0      0x8   Misc_PhysicalAddress:          0x1000
0x1D0      0x8   Misc_VirtualSize:              0x1000
0x1D4      0xC   VirtualAddress:                0x92000
0x1D8      0x10  SizeOfRawData:                 0x200
0x1DC      0x14  PointerToRawData:              0x28400
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              39/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-40">
          <div class="inner">
            
            <header><h1>PEiD</h1></header>
            
            
            <section><p><img alt="ssdeepun" src="..\slideResources\peb\ssdeepun.png" /></p>
<p><img alt="ssdeepPacked" src="..\slideResources\peb\ssdeepPacked.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              40/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-41">
          <div class="inner">
            
            <header><h1>Imports</h1></header>
            
            
            <section><p><strong>Unpacked</strong></p>
<div class="highlight"><pre>c:<span class="se">\b</span>in&gt;peparser.py -f ssdeep.exe -i 
----------Imported dll<span class="err">&#39;</span>s----------
KERNEL32.dll
        0x48c2e0 CloseHandle
        0x48c2e4 CreateSemaphoreA
        0x48c2e8 DeleteCriticalSection
        0x48c2ec EnterCriticalSection
        0x48c2f0 FindClose
        0x48c2f4 FindFirstFileW
        0x48c2f8 FindNextFileW
        0x48c2fc GetCommandLineW
        0x48c300 GetCurrentProcess
        0x48c304 GetCurrentProcessId
        0x48c308 GetCurrentThreadId
        0x48c30c GetLastError
        0x48c310 GetModuleFileNameW
        0x48c314 GetModuleHandleA
        0x48c318 GetModuleHandleW
        0x48c31c GetProcAddress
        0x48c320 GetStartupInfoA
        0x48c324 GetSystemTimeAsFileTime
        0x48c328 GetTickCount
        0x48c32c InitializeCriticalSection
        0x48c330 IsDBCSLeadByteEx
        0x48c334 LeaveCriticalSection
        0x48c338 MultiByteToWideChar
        0x48c33c QueryPerformanceCounter
        0x48c340 ReleaseSemaphore
        0x48c344 SetLastError
        0x48c348 SetUnhandledExceptionFilter
        0x48c34c Sleep
        0x48c350 TerminateProcess
        0x48c354 TlsAlloc
        0x48c358 TlsFree
        0x48c35c TlsGetValue
        0x48c360 TlsSetValue
        0x48c364 UnhandledExceptionFilter
        0x48c368 VirtualProtect
        0x48c36c VirtualQuery
        0x48c370 WaitForSingleObject
        0x48c374 WideCharToMultiByte
msvcrt.dll
        0x48c37c __argv
        0x48c380 __dllonexit
        0x48c384 __doserrno
        0x48c388 __getmainargs
        0x48c38c __initenv
        0x48c390 __lconv_init
        0x48c394 __mb_cur_max
        0x48c398 __pioinfo
        0x48c39c __set_app_type
        0x48c3a0 __setusermatherr
        0x48c3a4 _acmdln
        0x48c3a8 _amsg_exit
        0x48c3ac _cexit
        0x48c3b0 _errno
        0x48c3b4 _exit
        0x48c3b8 _filelengthi64
        0x48c3bc _fileno
        0x48c3c0 _fmode
        0x48c3c4 _fstat64
        0x48c3c8 _initterm
        0x48c3cc _iob
        0x48c3d0 _lock
        0x48c3d4 _lseeki64
        0x48c3d8 _onexit
        0x48c3dc _snwprintf
        0x48c3e0 _strnicmp
        0x48c3e4 atol
        0x48c3e8 calloc
        0x48c3ec <span class="nb">exit</span>
<span class="nb">        </span>0x48c3f0 fclose
        0x48c3f4 feof
        0x48c3f8 ferror
        0x48c3fc fflush
        0x48c400 fgetpos
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              41/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-42">
          <div class="inner">
            
            <header><h1>Imports</h1></header>
            
            
            <section><p><strong>Packed</strong></p>
<div class="highlight"><pre>c:<span class="se">\b</span>in&gt;peparser.py -f ssdeepPacked.exe -i
----------Imported dll<span class="err">&#39;</span>s----------
KERNEL32.DLL
        0x492064 LoadLibraryA
        0x492068 GetProcAddress
        0x49206c VirtualProtect
        0x492070 VirtualAlloc
        0x492074 VirtualFree
        0x492078 ExitProcess
msvcrt.dll
        0x492080 _iob
SHELL32.DLL
        0x492088 CommandLineToArgvW
USER32.dll
        0x492090 MessageBoxW
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
              <p>peparser is a small wrapper on pefile.py </p>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              42/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-43">
          <div class="inner">
            
            <header><h1>ProcDump</h1></header>
            
            
            <section><p>Dump a process to an executable file sample</p>
<div class="highlight"><pre>-o OFFSET, --offset<span class="o">=</span>OFFSET
                EPROCESS offset <span class="o">(</span>in hex<span class="o">)</span> in the physical address space
-p 352, --pid<span class="o">=</span>PID     Operate on these Process IDs <span class="o">(</span>comma-separated<span class="o">)</span>
-n NAME, --name<span class="o">=</span>NAME  Operate on these process names <span class="o">(</span>regex<span class="o">)</span>
-D DUMP_DIR, --dump-dir<span class="o">=</span>DUMP_DIR
                Directory in which to dump executable files
-u, --unsafe          Bypasses certain sanity checks when creating image
-m, --memory          Carve as a memory sample rather than exe/disk
-x, --fix             Modify the image base of the dump to the im-memory
                base address
</pre></div>

<p><br></p>
<div class="highlight"><pre><span class="o">[</span>root<span class="p">&amp;</span>windows<span class="o">]</span><span class="c">#volatility -f Win7.bin --profile=Win7SP0x86 -p 352 procdump -D .</span>
Volatility Foundation Volatility Framework 2.4
Process<span class="o">(</span>V<span class="o">)</span> ImageBase  Name                 Result
---------- ---------- -------------------- ------
0x8625b420 0x00990000 explorer.exe         OK: executable.352.exe
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              43/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-44">
          <div class="inner">
            
            <header><h1>Code Injection</h1></header>
            
            
            <section><p>Common practice with malware and exploitation</p>
<p>Remote DLL injection</p>
<ul>
<li>Process forces another to load a DLL from disk</li>
</ul>
<p>Remote code injection</p>
<ul>
<li>Process writes code into another process and forces execution</li>
</ul>
<p>Reflective DLL injection</p>
<ul>
<li>Process writes a DLL into remote process space and it loads itself from a specific loader stub</li>
</ul>
<p>Hollow process injection</p>
<ul>
<li>Process is started as suspended and memory space is blotted over with other code</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              44/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-45">
          <div class="inner">
            
            <header><h1>Remote DLL Injection</h1></header>
            
            
            <section><p>Loaded Library is used </p>
<p>Registers in PEB.LDR if not unlinked. </p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">kernel32</span> <span class="o">=</span> <span class="n">windll</span><span class="o">.</span><span class="n">kernel32</span>  
<span class="c">#PROCESS_CREATE_THREAD |  PROCESS_QUERY_INFORMATION | PROCESS_VM_OPERATION |  PROCESS_VM_WRITE | PROCESS_VM_READ</span>
<span class="n">PROCESS_ACCESS</span>  <span class="o">=</span> <span class="p">(</span> <span class="mh">0x0080</span> <span class="o">|</span> <span class="mh">0x0400</span> <span class="o">|</span> <span class="mh">0x0008</span> <span class="o">|</span>  <span class="mh">0x0020</span> <span class="o">|</span> <span class="mh">0x0010</span> <span class="p">)</span> 
<span class="n">PROCESS_ACCESS</span> <span class="o">=</span> <span class="p">(</span> <span class="mh">0x00F0000</span> <span class="o">|</span> <span class="mh">0x00100000</span> <span class="o">|</span> <span class="mh">0xFFF</span> <span class="p">)</span>
<span class="c">#  MEM_COMMIT | MEM_RESERVE</span>
<span class="n">MEMORY</span>  <span class="o">=</span> <span class="p">(</span> <span class="mh">0x1000</span> <span class="o">|</span> <span class="mh">0x2000</span> <span class="p">)</span>
<span class="c">#PAGE_EXECUTE_READWRITE</span>
<span class="n">PAGE_EXECUTE_READWRITE</span> <span class="o">=</span> <span class="mh">0x04</span>
<span class="n">pid</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">dll_path</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&quot;Going to inject into </span><span class="si">%s</span><span class="s"> with </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">dll_path</span><span class="p">)</span>
<span class="c">#Step 1: Open a handle to a process</span>
<span class="n">handleToProcess</span> <span class="o">=</span> <span class="n">kernel32</span><span class="o">.</span><span class="n">OpenProcess</span><span class="p">(</span><span class="n">PROCESS_ACCESS</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">pid</span><span class="p">))</span>
<span class="c">#Step 2: allocate memory for the process (Just enough for the PATH of the dll you want to load into it)</span>
<span class="n">dll_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dll_path</span><span class="p">)</span>
<span class="c">#2.1 allocate space for the dll_path in the process</span>
<span class="n">virtualAllocated</span> <span class="o">=</span> <span class="n">kernel32</span><span class="o">.</span><span class="n">VirtualAllocEx</span><span class="p">(</span><span class="n">handleToProcess</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dll_length</span><span class="p">,</span> <span class="n">MEMORY</span><span class="p">,</span> <span class="n">PAGE_EXECUTE_READWRITE</span><span class="p">)</span>
<span class="c">#Step 3: Find location of LoadLibrary and write memory into remote process</span>
<span class="n">null</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernel32</span><span class="o">.</span><span class="n">WriteProcessMemory</span><span class="p">(</span><span class="n">handleToProcess</span><span class="p">,</span> <span class="n">virtualAllocated</span><span class="p">,</span> <span class="n">dll_path</span><span class="p">,</span> <span class="n">dll_length</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">null</span><span class="p">))</span>
<span class="n">handle</span> <span class="o">=</span> <span class="n">kernel32</span><span class="o">.</span><span class="n">GetModuleHandleA</span><span class="p">(</span><span class="s">&quot;kernel32.dll&quot;</span><span class="p">)</span>
<span class="n">loadedDll</span> <span class="o">=</span> <span class="n">kernel32</span><span class="o">.</span><span class="n">GetProcAddress</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s">&quot;LoadLibraryA&quot;</span><span class="p">)</span>
<span class="c">#Step 4: Run LoadLibraryA on remote target pointing to our DLL!</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">c_ulong</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">if</span> <span class="n">kernel32</span><span class="o">.</span><span class="n">CreateRemoteThread</span><span class="p">(</span><span class="n">handleToProcess</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">loadedDll</span><span class="p">,</span> <span class="n">virtualAllocated</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="nb">id</span><span class="p">)):</span>
<span class="k">print</span> <span class="s">&quot;injected!&quot;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              45/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-46">
          <div class="inner">
            
            <header><h1>Hollow Process Injection</h1></header>
            
            
            <section><p>Stuxnet used this on lsass</p>
<p>Create a process suspended</p>
<p>Free memory of original executable .code and insert malicious code sections.</p>
<p>Resume the process.</p>
<p>https://www.trustwave.com/Resources/SpiderLabs-Blog/Analyzing-Malware-Hollow-Processes/</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              46/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-47">
          <div class="inner">
            
            
            <section><p><img alt="HollowProcess" src="..\slideResources\peb\hollowProcess.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              47/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-48">
          <div class="inner">
            
            <header><h1>Hollow Process Injection</h1></header>
            
            
            <section><p>Uses undocumented Nt functions to unmap sections from memory </p>
<div class="highlight"><pre><span class="k">typedef</span> <span class="nf">NTSTATUS</span><span class="p">(</span><span class="kr">__stdcall</span><span class="o">*</span> <span class="n">pNtUnmapViewOfSection</span><span class="p">)(</span><span class="n">HANDLE</span> <span class="n">ProcessHandle</span><span class="p">,</span> <span class="n">PVOID</span> <span class="n">BaseAddress</span><span class="p">);</span>
</pre></div>

<p>Parses though the PE header of two files.. the replacer and reaplcee</p>
<ol>
<li>Create a process in a suspended state</li>
<li>Unmap sections that overlap and the image base</li>
<li>Virtual alloc memory into target process at replacers image base and size of image</li>
<li>Write the PE header into the target process of replacer</li>
<li>Go through each section and write it into target</li>
<li>Get the thread context of target and set eax to the imageBase+AddressOfEntryPoint</li>
<li>Resume the main thread, now holding the replacement processes code</li>
</ol></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              48/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-49">
          <div class="inner">
            
            <header><h1>Detecting Hollow Injection</h1></header>
            
            
            <section><p>RWX memory</p>
<ul>
<li>Unless malware author is cute</li>
<li>File size of process differs</li>
</ul>
<p>Fuzzy hashing</p>
<ul>
<li>Commonality between files</li>
<li><a href="http://ssdeep.sourceforge.net/" title="ssdeep">Ssdeep</a> </li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              49/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-50">
          <div class="inner">
            
            <header><h1>Fuzzy Hashing</h1></header>
            
            
            <section><p>Common in malware research</p>
<p>Used as indicator of similarities in files</p>
<p>Higher hash number = more similarities </p>
<p>ssdeep is open source freeware for fuzzy hashing by Jesse Kornblum</p>
<p><a href="https://c.ymcdn.com/sites/www.issa.org/resource/resmgr/journalpdfs/fuzzyhash-issa-journal0813.pdf" title="Great read">Great read</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              50/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-51">
          <div class="inner">
            
            <header><h1>Ssdeep</h1></header>
            
            
            <section><div class="highlight"><pre>Usage: ssdeep <span class="o">[</span>-m file<span class="o">]</span> <span class="o">[</span>-k file<span class="o">]</span> <span class="o">[</span>-dpgvrsblcxa<span class="o">]</span> <span class="o">[</span>-t val<span class="o">]</span> <span class="o">[</span>-h<span class="p">|</span>-V<span class="o">]</span> <span class="o">[</span>FILES<span class="o">]</span>
-m - Match FILES against known hashes in file
-k - Match signatures in FILES against signatures in file
-d - Directory mode, compare all files in a directory
-p - Pretty matching mode. Similar to -d but includes all matches
-g - Cluster matches together
-v - Verbose mode. Displays filename as its being processed
-r - Recursive mode
-s - Silent mode<span class="p">;</span> all errors are supressed
-b - Uses only the bare name of files<span class="p">;</span> all path information omitted
-l - Uses relative paths <span class="k">for</span> filenames
-c - Prints output in CSV format
-x - Compare FILES as signature files
-a - Display all matches, regardless of score
-t - Only displays matches above the given threshold
-h - Display this <span class="nb">help </span>message
-V - Display version number and <span class="nb">exit</span>

c:<span class="se">\b</span>in&gt;ssdeep.exe -d reg.pdf mal.pdf
mal.pdf matches c:<span class="se">\b</span>in<span class="se">\r</span>eg.pdf <span class="o">(</span>99<span class="o">)</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              51/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-52">
          <div class="inner">
            
            <header><h1>Readable, Writable, Executable</h1></header>
            
            
            <section><p>Injected code typically has page permissions of readable, writable and executable (rwx).</p>
<p>Pages must be readable and executable for the CPU to run code, hence why .text/.code is rx.</p>
<p>If a page is wx, attacker can write into memory and execute arbitrary code.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              52/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-53">
          <div class="inner">
            
            <header><h1>Changing Page Permissions</h1></header>
            
            
            <section><p>Recall from the remote DLL injection we used VirtualAllocEX on memory to make it PAGE_EXECUTE_READWRITE.</p>
<p>After injection Attackers clean up and call VirtualProtectEx to make page rx</p>
<div class="highlight"><pre>BOOL WINAPI VirtualProtectEx<span class="o">(</span>
  _In_   HANDLE hProcess,
  _In_   LPVOID lpAddress,
  _In_   SIZE_T dwSize,
  _In_   DWORD flNewProtect,
  _Out_  PDWORD lpflOldProtect
<span class="o">)</span><span class="p">;</span>
</pre></div>

<p>Do not always <strong>rely</strong> <strong>on rwx</strong> for injected code</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              53/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-54">
          <div class="inner">
            
            <header><h1>Advanced Authors</h1></header>
            
            
            <section><p>Never make page rwx</p>
<p>Start with PAGE_READWRITE and put code into memory</p>
<p>Change page to PAGE_EXECUTE_READ after writing </p>
<p>Now there are no RWX pages every allocated. </p>
<ul>
<li>RW when copying data</li>
<li>RX when executing</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              54/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-55">
          <div class="inner">
            
            <header><h1>Malfind</h1></header>
            
            
            <section><p>Volatility plugin to find injected code. </p>
<p>Scans for RWX private memory regions</p>
<p>Some false positives...</p>
<ul>
<li>Analyze disassembly output</li>
</ul>
<p>Use VAD plugins to cross reference findings.</p>
<p>Useful to find signatures to write Yara rules on! </p>
<p>-D to dump sections to disk. </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              55/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-56">
          <div class="inner">
            
            <header><h1>Impscan</h1></header>
            
            
            <section><p>Scan for calls to imported functions</p>
<p>Useful with addresses from Malfind</p>
<p>IAT might not be reconstructed when carved out of memory</p>
<ul>
<li>-b base address from malfind</li>
</ul>
<p>If not, scans main module of process</p>
<ul>
<li>-p PID</li>
</ul>
<p>Can output new IAT as an idc file to insert into IDA.</p>
<ul>
<li>--output=Module<ul>
<li>Module Output Options: idc, text</li>
</ul>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              56/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-57">
          <div class="inner">
            
            <header><h1>Usage</h1></header>
            
            
            <section><div class="highlight"><pre>0x863cc540 ProcessHacker.         <span class="nv">PID</span> <span class="o">=</span> 1108
<span class="o">[</span>root<span class="p">&amp;</span>windows<span class="o">]</span><span class="c">#volatility -f Win7.bin --profile=Win7SP0x86 impscan -p 1108</span>
Volatility Foundation Volatility Framework 2.4
IAT        Call       Module               Function
---------- ---------- -------------------- --------
0x012d9000 0x77764251 ADVAPI32.dll         LsaLookupPrivilegeValue
0x012d9004 0x7779a469 ADVAPI32.dll         LsaEnumerateAccounts
0x012d9008 0x7775c7a6 ADVAPI32.dll         SetServiceStatus
0x012d9010 0x7775a965 ADVAPI32.dll         StartServiceCtrlDispatcherW
0x012d9014 0x777930f8 ADVAPI32.dll         ChangeServiceConfigW
0x012d9018 0x77798819 ADVAPI32.dll         LsaAddAccountRights
0x012d901c 0x7775b466 ADVAPI32.dll         EnumServicesStatusExW
0x012d9020 0x7775b537 ADVAPI32.dll         QueryServiceConfigW
0x012d9024 0x777930d8 ADVAPI32.dll         ChangeServiceConfig2W
0x012d9028 0x7777712c ADVAPI32.dll         CreateServiceW
0x012d902c 0x7776369c ADVAPI32.dll         CloseServiceHandle
0x012d9030 0x7777715c ADVAPI32.dll         DeleteService
0x012d9034 0x7775ca64 ADVAPI32.dll         OpenSCManagerW
0x012d9038 0x7775ca4c ADVAPI32.dll         OpenServiceW
0x012d903c 0x77757974 ADVAPI32.dll         StartServiceW
0x012d9040 0x77777144 ADVAPI32.dll         ControlService
0x012d9044 0x777793dc ADVAPI32.dll         LsaLookupSids
0x012d9048 0x7777077c ADVAPI32.dll         LsaOpenPolicy
0x012d904c 0x777933f9 ADVAPI32.dll         QueryServiceConfig2W
0x012d9050 0x77799e99 ADVAPI32.dll         LsaLookupPrivilegeDisplayName
0x012d9054 0x77777cdc ADVAPI32.dll         LsaLookupNames2
0x012d9058 0x77771af7 ADVAPI32.dll         LsaClose
0x012d905c 0x77799df1 ADVAPI32.dll         LsaLookupPrivilegeName
0x012d9060 0x7776ede1 ADVAPI32.dll         LsaFreeMemory
0x012d9078 0x7775c592 ADVAPI32.dll         CreateProcessAsUserW
0x012d9088 0x744f09ce COMCTL32.dll         InitCommonControlsEx
0x012d908c 0x74512607 COMCTL32.dll         CreatePropertySheetPageW
0x012d9090 0x7451388e COMCTL32.dll         PropertySheetW
0x012d9098 0x744e3c75 COMCTL32.dll         ImageList_Create
0x012d909c 0x745246d0 COMCTL32.dll         ImageList_Replace
0x012d90ac 0x75d9a36e COMDLG32.dll         GetSaveFileNameW
0x012d90b0 0x75d9a2d5 COMDLG32.dll         GetOpenFileNameW
0x012d90b4 0x75d90d68 COMDLG32.dll         ChooseColorW
0x012d90c0 0x75d1cff1 GDI32.dll            SetDCBrushColor
0x012d90c4 0x75d15f14 GDI32.dll            DeleteObject
0x012d90c8 0x75d205cf GDI32.dll            Polyline
0x012d90cc 0x75d183f2 GDI32.dll            GdiAlphaBlend
0x012d90d0 0x75d16888 GDI32.dll            CreateCompatibleDC
0x012d90d4 0x75d169b1 GDI32.dll            SetBkMode
0x012d90d8 0x75d18850 GDI32.dll            CreateDIBSection
0x012d90dc 0x75d1fb87 GDI32.dll            Polygon
0x012d90e0 0x75d16eaa GDI32.dll            DeleteDC
0x012d90e4 0x75d16906 GDI32.dll            SetTextColor
0x012d90e8 0x75d1b4b5 GDI32.dll            GetTextExtentPoint32W
0x012d90ec 0x75d172c0 GDI32.dll            BitBlt
0x012d90f8 0x75d1c204 GDI32.dll            CreateFontW
0x012d90fc 0x75d16640 GDI32.dll            SelectObject
0x012d9104 0x75d1a23b GDI32.dll            GetDIBits
0x012d9108 0x75d1a67b GDI32.dll            RestoreDC
0x012d910c 0x75d17dfe GDI32.dll            IntersectClipRect
0x012d9110 0x75d1633b GDI32.dll            CreateRectRgn
0x012d9114 0x75d1a74b GDI32.dll            SaveDC
0x012d9118 0x75d1651e GDI32.dll            CombineRgn
0x012d9120 0x75d19218 GDI32.dll            ExcludeClipRect
0x012d9124 0x75d1abfc GDI32.dll            CreateFontIndirectW
0x012d9128 0x75d17b8f GDI32.dll            GetTextMetricsW
0x012d912c 0x75d17f2d GDI32.dll            GetClipRgn
0x012d9130 0x75d17568 GDI32.dll            GetObjectW
0x012d9134 0x75d16f7f GDI32.dll            GetDeviceCaps
0x012d9138 0x75d1f1ff GDI32.dll            Rectangle
0x012d913c 0x75d310c0 GDI32.dll            SetDCPenColor
0x012d9140 0x75d15ddf GDI32.dll            GetStockObject
0x012d9144 0x75d173ad GDI32.dll            CreateCompatibleBitmap
0x012d9148 0x75d17242 GDI32.dll            SelectClipRgn
0x012d9150 0x76e1527c kernel32.dll         LCMapStringW
0x012d9154 0x76e20641 kernel32.dll         UnhandledExceptionFilter
0x012d9158 0x76e0f4eb kernel32.dll         SetUnhandledExceptionFilter
0x012d915c 0x76e0d790 kernel32.dll         GetCurrentProcess
---SNIP---
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              57/58
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: week03_02-Malware.md -->
      <div class="slide-wrapper">
        <div class="slide slide-58">
          <div class="inner">
            
            <header><h1>EOF</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="week03_02-Malware.md">week03_02-Malware.md</a>
            </aside>
            
            <aside class="page_number">
              58/58
            </aside>
          </footer>
        </div>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
      
      <tr id="toc-row-1">
        <th><a href="#slide1">Malware</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      
      
      <tr id="toc-row-2">
        <th><a href="#slide2">Obligatory Disclaimer</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      
      
      <tr id="toc-row-3">
        <th><a href="#slide3">Process Environment Block (PEB)</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      
      
      <tr id="toc-row-4">
        <th><a href="#slide4">PEB</a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      
      
      <tr id="toc-row-5">
        <th><a href="#slide5">_PEB</a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
      
      
      <tr id="toc-row-6">
        <th><a href="#slide6">_RTL_USER_PROCESS_PARAMETERS</a></th>
        <td><a href="#slide6">6</a></td>
      </tr>
      
      
      <tr id="toc-row-7">
        <th><a href="#slide7">DLL Loading</a></th>
        <td><a href="#slide7">7</a></td>
      </tr>
      
      
      <tr id="toc-row-8">
        <th><a href="#slide8">PEB_LDR_DATA</a></th>
        <td><a href="#slide8">8</a></td>
      </tr>
      
      
      <tr id="toc-row-9">
        <th><a href="#slide9">DATA_TABLE_ENTRY</a></th>
        <td><a href="#slide9">9</a></td>
      </tr>
      
      
      <tr id="toc-row-10">
        <th><a href="#slide10">_PEB Enumeration</a></th>
        <td><a href="#slide10">10</a></td>
      </tr>
      
      
      <tr id="toc-row-11">
        <th><a href="#slide11">Enumeration</a></th>
        <td><a href="#slide11">11</a></td>
      </tr>
      
      
      <tr id="toc-row-12">
        <th><a href="#slide12">With Volatility</a></th>
        <td><a href="#slide12">12</a></td>
      </tr>
      
      
      <tr id="toc-row-13">
        <th><a href="#slide13">Environment Variables</a></th>
        <td><a href="#slide13">13</a></td>
      </tr>
      
      
      <tr id="toc-row-14">
        <th><a href="#slide14">Environment Variables</a></th>
        <td><a href="#slide14">14</a></td>
      </tr>
      
      
      <tr id="toc-row-15">
        <th><a href="#slide15">ENV: Continued</a></th>
        <td><a href="#slide15">15</a></td>
      </tr>
      
      
      <tr id="toc-row-16">
        <th><a href="#slide16">ENV</a></th>
        <td><a href="#slide16">16</a></td>
      </tr>
      
      
      <tr id="toc-row-17">
        <th><a href="#slide17">Process Heaps</a></th>
        <td><a href="#slide17">17</a></td>
      </tr>
      
      
      <tr id="toc-row-18">
        <th><a href="#slide18">Standard Handles</a></th>
        <td><a href="#slide18">18</a></td>
      </tr>
      
      
      <tr id="toc-row-19">
        <th><a href="#slide19">Standard Handles</a></th>
        <td><a href="#slide19">19</a></td>
      </tr>
      
      
      <tr id="toc-row-20">
        <th><a href="#slide20">Dynamic Link Libraries (DLLs)</a></th>
        <td><a href="#slide20">20</a></td>
      </tr>
      
      
      <tr id="toc-row-21">
        <th><a href="#slide21">DLLs</a></th>
        <td><a href="#slide21">21</a></td>
      </tr>
      
      
      <tr id="toc-row-22">
        <th><a href="#slide22">How DLL Unlinking Works</a></th>
        <td><a href="#slide22">22</a></td>
      </tr>
      
      
      <tr id="toc-row-23">
        <th><a href="#slide23">DllList</a></th>
        <td><a href="#slide23">23</a></td>
      </tr>
      
      
      <tr id="toc-row-24">
        <th><a href="#slide24">DllList</a></th>
        <td><a href="#slide24">24</a></td>
      </tr>
      
      
      <tr id="toc-row-25">
        <th><a href="#slide25">DLL Detection if Unlinked</a></th>
        <td><a href="#slide25">25</a></td>
      </tr>
      
      
      <tr id="toc-row-26">
        <th><a href="#slide26">ldrmodules</a></th>
        <td><a href="#slide26">26</a></td>
      </tr>
      
      
      <tr id="toc-row-27">
        <th><a href="#slide27">ldrmodules</a></th>
        <td><a href="#slide27">27</a></td>
      </tr>
      
      
      <tr id="toc-row-28">
        <th><a href="#slide28">DLLDump</a></th>
        <td><a href="#slide28">28</a></td>
      </tr>
      
      
      <tr id="toc-row-29">
        <th><a href="#slide29">PE In Memory</a></th>
        <td><a href="#slide29">29</a></td>
      </tr>
      
      
      <tr id="toc-row-30">
        <th><a href="#slide30">In Memory</a></th>
        <td><a href="#slide30">30</a></td>
      </tr>
      
      
      <tr id="toc-row-31">
        <th><a href="#slide31">Volatility</a></th>
        <td><a href="#slide31">31</a></td>
      </tr>
      
      
      <tr id="toc-row-32">
        <th><a href="#slide32">Packing PE Files</a></th>
        <td><a href="#slide32">32</a></td>
      </tr>
      
      
      <tr id="toc-row-33">
        <th><a href="#slide33">Other Notes</a></th>
        <td><a href="#slide33">33</a></td>
      </tr>
      
      
      <tr id="toc-row-34">
        <th><a href="#slide34">Original Entry Point (OEP)</a></th>
        <td><a href="#slide34">34</a></td>
      </tr>
      
      
      <tr id="toc-row-35">
        <th><a href="#slide35">-</a></th>
        <td><a href="#slide35">35</a></td>
      </tr>
      
      
      <tr id="toc-row-36">
        <th><a href="#slide36">Detecting Packed Binaries</a></th>
        <td><a href="#slide36">36</a></td>
      </tr>
      
      
      <tr id="toc-row-37">
        <th><a href="#slide37">BUT</a></th>
        <td><a href="#slide37">37</a></td>
      </tr>
      
      
      <tr id="toc-row-38">
        <th><a href="#slide38">Detecting packing on sizes</a></th>
        <td><a href="#slide38">38</a></td>
      </tr>
      
      
      <tr id="toc-row-39">
        <th><a href="#slide39">Detecting packing on sizes</a></th>
        <td><a href="#slide39">39</a></td>
      </tr>
      
      
      <tr id="toc-row-40">
        <th><a href="#slide40">PEiD</a></th>
        <td><a href="#slide40">40</a></td>
      </tr>
      
      
      <tr id="toc-row-41">
        <th><a href="#slide41">Imports</a></th>
        <td><a href="#slide41">41</a></td>
      </tr>
      
      
      <tr id="toc-row-42">
        <th><a href="#slide42">Imports</a></th>
        <td><a href="#slide42">42</a></td>
      </tr>
      
      
      <tr id="toc-row-43">
        <th><a href="#slide43">ProcDump</a></th>
        <td><a href="#slide43">43</a></td>
      </tr>
      
      
      <tr id="toc-row-44">
        <th><a href="#slide44">Code Injection</a></th>
        <td><a href="#slide44">44</a></td>
      </tr>
      
      
      <tr id="toc-row-45">
        <th><a href="#slide45">Remote DLL Injection</a></th>
        <td><a href="#slide45">45</a></td>
      </tr>
      
      
      <tr id="toc-row-46">
        <th><a href="#slide46">Hollow Process Injection</a></th>
        <td><a href="#slide46">46</a></td>
      </tr>
      
      
      <tr id="toc-row-47">
        <th><a href="#slide47">-</a></th>
        <td><a href="#slide47">47</a></td>
      </tr>
      
      
      <tr id="toc-row-48">
        <th><a href="#slide48">Hollow Process Injection</a></th>
        <td><a href="#slide48">48</a></td>
      </tr>
      
      
      <tr id="toc-row-49">
        <th><a href="#slide49">Detecting Hollow Injection</a></th>
        <td><a href="#slide49">49</a></td>
      </tr>
      
      
      <tr id="toc-row-50">
        <th><a href="#slide50">Fuzzy Hashing</a></th>
        <td><a href="#slide50">50</a></td>
      </tr>
      
      
      <tr id="toc-row-51">
        <th><a href="#slide51">Ssdeep</a></th>
        <td><a href="#slide51">51</a></td>
      </tr>
      
      
      <tr id="toc-row-52">
        <th><a href="#slide52">Readable, Writable, Executable</a></th>
        <td><a href="#slide52">52</a></td>
      </tr>
      
      
      <tr id="toc-row-53">
        <th><a href="#slide53">Changing Page Permissions</a></th>
        <td><a href="#slide53">53</a></td>
      </tr>
      
      
      <tr id="toc-row-54">
        <th><a href="#slide54">Advanced Authors</a></th>
        <td><a href="#slide54">54</a></td>
      </tr>
      
      
      <tr id="toc-row-55">
        <th><a href="#slide55">Malfind</a></th>
        <td><a href="#slide55">55</a></td>
      </tr>
      
      
      <tr id="toc-row-56">
        <th><a href="#slide56">Impscan</a></th>
        <td><a href="#slide56">56</a></td>
      </tr>
      
      
      <tr id="toc-row-57">
        <th><a href="#slide57">Usage</a></th>
        <td><a href="#slide57">57</a></td>
      </tr>
      
      
      <tr id="toc-row-58">
        <th><a href="#slide58">EOF</a></th>
        <td><a href="#slide58">58</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Exposé</th>
        <td>ESC</td>
      </tr>
      <tr>
        <th>Full screen slides</th>
        <td>e</td>
      </tr>
      <tr>
        <th>Presenter View</th>
        <td>p</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Toggle screen blanking</th>
        <td>b</td>
      </tr>
      <tr>
        <th>Show/hide slide context</th>
        <td>c</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
  </div>
  <script>main()</script>
</body>
</html>
